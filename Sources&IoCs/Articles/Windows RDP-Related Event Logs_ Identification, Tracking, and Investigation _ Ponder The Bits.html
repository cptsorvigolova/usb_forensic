<!DOCTYPE html>
<!-- saved from url=(0107)https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/ -->
<html class="js js csstransforms csstransforms3d csstransitions" lang="en-US"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

		
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Windows RDP-Related Event Logs: Identification, Tracking, and Investigation | Ponder The Bits</title>

		<!-- All in One SEO 4.1.4.4 -->
		<meta name="description" content="A cohesive and comprehensive walk-through of the most common and empirically useful RDP-related Windows Event Log Sources and ID&#39;s, grouped by stage of occurrence (Connection, Authentication, Logon, Disconnect/Reconnect, Logoff).">
		<meta name="robots" content="max-image-preview:large">
		<meta name="keywords" content="incident response,windows,forensics,event logs,rdp,remote desktop,uncategorized">
		<link rel="canonical" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/">
		<meta name="google" content="nositelinkssearchbox">
		<script id="twitter-wjs" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/widgets.js.Без названия"></script><script type="application/ld+json" class="aioseo-schema">
			{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebSite","@id":"https:\/\/ponderthebits.com\/#website","url":"https:\/\/ponderthebits.com\/","name":"Ponder The Bits","description":"Musings and confusings. All things DFIR.","inLanguage":"en-US","publisher":{"@id":"https:\/\/ponderthebits.com\/#person"}},{"@type":"Person","@id":"https:\/\/ponderthebits.com\/#person","name":"Jonathon Poling"},{"@type":"BreadcrumbList","@id":"https:\/\/ponderthebits.com\/2018\/02\/windows-rdp-related-event-logs-identification-tracking-and-investigation\/#breadcrumblist","itemListElement":[{"@type":"ListItem","@id":"https:\/\/ponderthebits.com\/#listItem","position":1,"item":{"@type":"WebPage","@id":"https:\/\/ponderthebits.com\/","name":"Home","description":"A blog by Jonathon Poling - Musings and posts on all things DFIR, both technical and non-technical.","url":"https:\/\/ponderthebits.com\/"},"nextItem":"https:\/\/ponderthebits.com\/2018\/#listItem"},{"@type":"ListItem","@id":"https:\/\/ponderthebits.com\/2018\/#listItem","position":2,"item":{"@type":"WebPage","@id":"https:\/\/ponderthebits.com\/2018\/","name":"2018","url":"https:\/\/ponderthebits.com\/2018\/"},"nextItem":"https:\/\/ponderthebits.com\/2018\/02\/#listItem","previousItem":"https:\/\/ponderthebits.com\/#listItem"},{"@type":"ListItem","@id":"https:\/\/ponderthebits.com\/2018\/02\/#listItem","position":3,"item":{"@type":"WebPage","@id":"https:\/\/ponderthebits.com\/2018\/02\/","name":"February","url":"https:\/\/ponderthebits.com\/2018\/02\/"},"nextItem":"https:\/\/ponderthebits.com\/2018\/02\/windows-rdp-related-event-logs-identification-tracking-and-investigation\/#listItem","previousItem":"https:\/\/ponderthebits.com\/2018\/#listItem"},{"@type":"ListItem","@id":"https:\/\/ponderthebits.com\/2018\/02\/windows-rdp-related-event-logs-identification-tracking-and-investigation\/#listItem","position":4,"item":{"@type":"WebPage","@id":"https:\/\/ponderthebits.com\/2018\/02\/windows-rdp-related-event-logs-identification-tracking-and-investigation\/","name":"Windows RDP-Related Event Logs: Identification, Tracking, and Investigation","description":"A cohesive and comprehensive walk-through of the most common and empirically useful RDP-related Windows Event Log Sources and ID's, grouped by stage of occurrence (Connection, Authentication, Logon, Disconnect\/Reconnect, Logoff).","url":"https:\/\/ponderthebits.com\/2018\/02\/windows-rdp-related-event-logs-identification-tracking-and-investigation\/"},"previousItem":"https:\/\/ponderthebits.com\/2018\/02\/#listItem"}]},{"@type":"Person","@id":"https:\/\/ponderthebits.com\/author\/jp\/#author","url":"https:\/\/ponderthebits.com\/author\/jp\/","name":"Jonathon Poling","image":{"@type":"ImageObject","@id":"https:\/\/ponderthebits.com\/2018\/02\/windows-rdp-related-event-logs-identification-tracking-and-investigation\/#authorImage","url":"https:\/\/secure.gravatar.com\/avatar\/c3896f35721bbb012deac10134f8dab6?s=96&d=mm&r=g","width":96,"height":96,"caption":"Jonathon Poling"}},{"@type":"WebPage","@id":"https:\/\/ponderthebits.com\/2018\/02\/windows-rdp-related-event-logs-identification-tracking-and-investigation\/#webpage","url":"https:\/\/ponderthebits.com\/2018\/02\/windows-rdp-related-event-logs-identification-tracking-and-investigation\/","name":"Windows RDP-Related Event Logs: Identification, Tracking, and Investigation | Ponder The Bits","description":"A cohesive and comprehensive walk-through of the most common and empirically useful RDP-related Windows Event Log Sources and ID's, grouped by stage of occurrence (Connection, Authentication, Logon, Disconnect\/Reconnect, Logoff).","inLanguage":"en-US","isPartOf":{"@id":"https:\/\/ponderthebits.com\/#website"},"breadcrumb":{"@id":"https:\/\/ponderthebits.com\/2018\/02\/windows-rdp-related-event-logs-identification-tracking-and-investigation\/#breadcrumblist"},"author":"https:\/\/ponderthebits.com\/author\/jp\/#author","creator":"https:\/\/ponderthebits.com\/author\/jp\/#author","datePublished":"2018-02-20T16:17:10-08:00","dateModified":"2019-10-01T16:01:13-07:00"},{"@type":"Article","@id":"https:\/\/ponderthebits.com\/2018\/02\/windows-rdp-related-event-logs-identification-tracking-and-investigation\/#article","name":"Windows RDP-Related Event Logs: Identification, Tracking, and Investigation | Ponder The Bits","description":"A cohesive and comprehensive walk-through of the most common and empirically useful RDP-related Windows Event Log Sources and ID's, grouped by stage of occurrence (Connection, Authentication, Logon, Disconnect\/Reconnect, Logoff).","inLanguage":"en-US","headline":"Windows RDP-Related Event Logs: Identification, Tracking, and Investigation","author":{"@id":"https:\/\/ponderthebits.com\/author\/jp\/#author"},"publisher":{"@id":"https:\/\/ponderthebits.com\/#person"},"datePublished":"2018-02-20T16:17:10-08:00","dateModified":"2019-10-01T16:01:13-07:00","commentCount":64,"articleSection":"Event Logs, Forensics, Incident Response, RDP, Remote Desktop, Uncategorized, Windows","mainEntityOfPage":{"@id":"https:\/\/ponderthebits.com\/2018\/02\/windows-rdp-related-event-logs-identification-tracking-and-investigation\/#webpage"},"isPartOf":{"@id":"https:\/\/ponderthebits.com\/2018\/02\/windows-rdp-related-event-logs-identification-tracking-and-investigation\/#webpage"},"image":{"@type":"ImageObject","@id":"https:\/\/ponderthebits.com\/#articleImage","url":"https:\/\/ponderthebits.com\/wp-content\/uploads\/2018\/02\/1149.png","width":970,"height":595}}]}
		</script>
		<script type="text/javascript">
			window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
			ga('create', "UA-89294439-1", { 'cookieDomain': 'ponderthebits.com' } );
			ga('send', 'pageview');
		</script>
		<script async="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/analytics.js.Без названия"></script>
		<!-- All in One SEO -->

<script>document.documentElement.className = document.documentElement.className.replace("no-js","js");</script>
<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Ponder The Bits » Feed" href="https://ponderthebits.com/feed/">
<link rel="alternate" type="application/rss+xml" title="Ponder The Bits » Comments Feed" href="https://ponderthebits.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Ponder The Bits » Windows RDP-Related Event Logs: Identification, Tracking, and Investigation Comments Feed" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/ponderthebits.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=2eb69d0bcb93c6f9e194380559a8c881"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/wp-emoji-release.min.js.Без названия" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="wp-block-library-css" href="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/style.min.css" type="text/css" media="all">
<link rel="stylesheet" id="cptch_stylesheet-css" href="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/front_end_style.css" type="text/css" media="all">
<link rel="stylesheet" id="dashicons-css" href="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/dashicons.min.css" type="text/css" media="all">
<link rel="stylesheet" id="cptch_desktop_style-css" href="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/desktop_style.css" type="text/css" media="all">
<link rel="stylesheet" id="SFSImainCss-css" href="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/sfsi-style.css" type="text/css" media="all">
<link rel="stylesheet" id="lovecraft_googlefonts-css" href="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/css" type="text/css" media="all">
<link rel="stylesheet" id="lovecraft_genericons-css" href="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/genericons.min.css" type="text/css" media="all">
<link rel="stylesheet" id="lovecraft_style-css" href="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/style.css" type="text/css" media="all">
<script type="text/javascript" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/cookies.js.Без названия" id="ionos-assistant-wp-cookies-js"></script><style></style>
<script type="text/javascript" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/jquery.min.js.Без названия" id="jquery-core-js"></script>
<script type="text/javascript" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/jquery-migrate.min.js.Без названия" id="jquery-migrate-js"></script>
<script type="text/javascript" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/weblizar-fronend-twitter-tweets.js.Без названия" id="wl-weblizar-fronend-twitter-tweets-js"></script>
<script type="text/javascript" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/doubletaptogo.min.js.Без названия" id="lovecraft_doubletap-js"></script>
<link rel="https://api.w.org/" href="https://ponderthebits.com/wp-json/"><link rel="alternate" type="application/json" href="https://ponderthebits.com/wp-json/wp/v2/posts/275"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://ponderthebits.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://ponderthebits.com/wp-includes/wlwmanifest.xml"> 

<link rel="shortlink" href="https://ponderthebits.com/?p=275">
<link rel="alternate" type="application/json+oembed" href="https://ponderthebits.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fponderthebits.com%2F2018%2F02%2Fwindows-rdp-related-event-logs-identification-tracking-and-investigation%2F">
<link rel="alternate" type="text/xml+oembed" href="https://ponderthebits.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fponderthebits.com%2F2018%2F02%2Fwindows-rdp-related-event-logs-identification-tracking-and-investigation%2F&amp;format=xml">
<meta name="follow.it-verification-code-TTRLWlV4Zk9MSGt3UFMvMitOQkFSN1JpblpHU3RiTVEvY3I0cFl3TVdZbVVuSDdsSEhBSDFxWGtGTm5xWnl5Um5ZTjVqeDNmUkRHN3luM3hKTEIvemErL05kRWI1Z3RUMTN5VkhCNGhUOERxU21teHJBZTdwUlpIY1JQdTdlMSt8R2YrYTY3UUZuNkp4S1NEeUFQZW9uL2NTSjN5dFZqNTBEMGJEMVFtY2p4OD0=" content="AkLKE6sbNvfvVEhdWc9j"><script type="text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//ponderthebits.com/?wordfence_lh=1&hid=57AB5696904142514B1E51CF4612482A');
</script><!-- Customizer CSS --><style type="text/css">a { color:#0087a3; }.blog-title a:hover { color:#0087a3; }.main-menu li:hover > a, .main-menu li.focus > a { color:#0087a3; }.main-menu > .menu-item-has-children > a:after { border-top-color:#0087a3; }blockquote:after { color:#0087a3; }button:hover, .button:hover, .faux-button:hover, .wp-block-button__link:hover, :root .wp-block-file__button:hover, input[type="button"]:hover, input[type="reset"]:hover, input[type="submit"]:hover { background-color:#0087a3; }.is-style-outline .wp-block-button__link:hover, .wp-block-button__link.is-style-outline:hover { color:#0087a3; }:root .has-accent-color { color:#0087a3; }:root .has-accent-background-color { background-color:#0087a3; }.post-tags a:hover { background-color:#0087a3; }.post-tags a:hover:before { border-right-color:#0087a3; }.post-content .page-links a:hover { background-color:#0087a3; }.post-navigation h4 a:hover { color:#0087a3; }.comments-title-link a { color:#0087a3; }.comments .pingbacks li a:hover { color:#0087a3; }.comment-header h4 a:hover { color:#0087a3; }.bypostauthor .comment-author-icon { background-color:#0087a3; }.form-submit #submit:hover { background-color:#0087a3; }.comments-nav a:hover { color:#0087a3; }.pingbacks-title { border-bottom-color:#0087a3; }.archive-navigation a:hover { color:#0087a3; }.widget-title { border-bottom-color:#0087a3; }.widget-content .textwidget a:hover { color:#0087a3; }.widget_archive li a:hover { color:#0087a3; }.widget_categories li a:hover { color:#0087a3; }.widget_meta li a:hover { color:#0087a3; }.widget_nav_menu li a:hover { color:#0087a3; }.widget_rss .widget-content ul a.rsswidget:hover { color:#0087a3; }#wp-calendar thead th { color:#0087a3; }#wp-calendar tfoot a:hover { color:#0087a3; }.widget .tagcloud a:hover { background-color:#0087a3; }.widget .tagcloud a:hover:before { border-right-color:#0087a3; }.footer .widget .tagcloud a:hover { background-color:#0087a3; }.footer .widget .tagcloud a:hover:before { border-right-color:#0087a3; }.credits .sep { color:#0087a3; }.credits a:hover { color:#0087a3; }.nav-toggle.active .bar { background-color:#0087a3; }.search-toggle.active .genericon { color:#0087a3; }.mobile-menu .current-menu-item:before { color:#0087a3; }.mobile-menu .current_page_item:before { color:#0087a3; }</style><!--/Customizer CSS--><link rel="icon" href="https://ponderthebits.com/wp-content/uploads/2016/12/brain-icon-png-2536-88x88.png" sizes="32x32">
<link rel="icon" href="https://ponderthebits.com/wp-content/uploads/2016/12/brain-icon-png-2536-e1482266829763.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://ponderthebits.com/wp-content/uploads/2016/12/brain-icon-png-2536-e1482266829763.png">
<meta name="msapplication-TileImage" content="https://ponderthebits.com/wp-content/uploads/2016/12/brain-icon-png-2536-e1482266829763.png">

	<script type="text/javascript" async="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/saved_resource"></script><meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Expires" content="0"><script charset="utf-8" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/moment_timeline.126ccbec3f6038135ffb4feab4485043.js.Без названия"></script><script charset="utf-8" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/timeline.f0018d9150722c67abdd0e6bbab13587.js.Без названия"></script></head>

	<body class="post-template-default single single-post postid-275 single-format-standard sfsi_2.63">

		
		<a class="skip-link button" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#site-content">Skip to the content</a>

		<header class="header-wrapper">

			<div class="header section bg-white small-padding">

				<div class="section-inner group">

					
						<div class="blog-title">
							<a href="https://ponderthebits.com/" rel="home">Ponder The Bits</a>
						</div>
					
													<h4 class="blog-tagline">Musings and confusings. All things DFIR.</h4>
											
					
				</div><!-- .section-inner -->

			</div><!-- .header -->

			<div class="toggles group">

				<button type="button" class="nav-toggle toggle">
					<div class="bar"></div>
					<div class="bar"></div>
					<div class="bar"></div>
					<span class="screen-reader-text">Toggle the mobile menu</span>
				</button>

				<button type="button" class="search-toggle toggle">
					<div class="genericon genericon-search"></div>
					<span class="screen-reader-text">Toggle the search field</span>
				</button>

			</div><!-- .toggles -->

		</header><!-- .header-wrapper -->

		<div class="navigation bg-white no-padding">

			<div class="section-inner group">

				<ul class="mobile-menu" style="display: none;">

					<li id="menu-item-21" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21"><a href="https://ponderthebits.com/">Home</a></li>
<li id="menu-item-341" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-341"><a href="https://ponderthebits.com/presentations-podcasts/">Presentations &amp; Podcasts</a></li>
<li id="menu-item-22" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-22"><a href="https://ponderthebits.com/about/">About Me</a></li>
<li id="menu-item-23" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-23"><a href="https://ponderthebits.com/dfir-resources/">DFIR Resources</a></li>

				</ul>

				<div class="mobile-search" style="display: none;">
					
<form method="get" class="search-form" id="search-form-615de04ca0116" action="https://ponderthebits.com/">
	<input type="search" class="search-field" placeholder="Search form" name="s" id="s-615de04ca0117">
	<button type="submit" class="search-button"><div class="genericon genericon-search"></div><span class="screen-reader-text">Search</span></button>
</form>
				</div><!-- .mobile-search -->

				<ul class="main-menu">

					<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21"><a href="https://ponderthebits.com/">Home</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-341"><a href="https://ponderthebits.com/presentations-podcasts/">Presentations &amp; Podcasts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-22"><a href="https://ponderthebits.com/about/">About Me</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-23"><a href="https://ponderthebits.com/dfir-resources/">DFIR Resources</a></li>

				</ul><!-- .main-menu -->

			</div><!-- .section-inner -->

		</div><!-- .navigation -->

		
			<figure class="header-image bg-image" style="background-image: url( https://ponderthebits.com/wp-content/uploads/2016/12/custom_header.jpg );">
				<img src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/custom_header.jpg">
			</figure>

		
		<main id="site-content">
<div class="wrapper section">

	<div class="section-inner group">

		<div class="content">

			
					<article id="post-275" class="post single post-275 type-post status-publish format-standard hentry category-event-logs category-forensics category-incident-response category-rdp category-remote-desktop category-uncategorized category-windows">

						<div class="post-inner">

							<div class="post-header">

								<h1 class="post-title"><a href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/">Windows RDP-Related Event Logs: Identification, Tracking, and Investigation</a></h1>

										
		<div class="post-meta">

			<p class="post-author"><span>By </span><a href="https://ponderthebits.com/author/jp/" title="Posts by Jonathon Poling" rel="author">Jonathon Poling</a></p>

			<p class="post-date"><span>On </span><a href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/">February 20, 2018</a></p>

							<p class="post-categories"><span>In </span><a href="https://ponderthebits.com/category/event-logs/" rel="category tag">Event Logs</a>, <a href="https://ponderthebits.com/category/forensics/" rel="category tag">Forensics</a>, <a href="https://ponderthebits.com/category/incident-response/" rel="category tag">Incident Response</a>, <a href="https://ponderthebits.com/category/rdp/" rel="category tag">RDP</a>, <a href="https://ponderthebits.com/category/remote-desktop/" rel="category tag">Remote Desktop</a>, <a href="https://ponderthebits.com/category/uncategorized/" rel="category tag">Uncategorized</a>, <a href="https://ponderthebits.com/category/windows/" rel="category tag">Windows</a></p>
			
			
		</div><!-- .post-meta -->

		
							</div><!-- .post-header -->

							
								<div class="post-content entry-content">

									<p>Early in my DFIR career, I struggled with understanding how exactly to identify and understand all the RDP-related Windows Event Logs. I would read a few things here and there, think I understood it, then move on to the next case – repeating the same loop over and over again and never really acquiring full comprehension. That is until one day I finally got tired of repeating the same questions/research and just made a cheat sheet laying out the most common RDP-related Event ID’s that I’d encountered along with their relevance and descriptions. From that point on, as I sporadically encountered related questions/confusion from others in the community, I would simply refer to my cheat sheet to provide an immediate response or clarification – saving them from the hours of repeated questioning and research I had already done.</p>
<p>However, it seems the community continues to encounter the same struggle in identifying and understanding RDP-related Windows Event Log ID’s, where each is located, and even what some of them mean (no thanks to some of Microsoft’s very confusing documentation and descriptions). As such, I recently set out to try and find an easy route to the solution for this problem (i.e. hopefully find a single website to point to with all this information). Though I’ve found parts of the answer in posts <a href="http://blog.kiddaland.net/2015/02/remote-desktop-connections-terminal.html">here</a> and <a href="https://countuponsecurity.com/2015/11/25/digital-forensics-supertimeline-event-logs-part-ii/">there</a>, each of them were missing parts of the puzzle (either missing ID’s, descriptions, explanations, and/or overall how they fit together in a chronological fashion). I will say JPCERTCC did an awesome job capturing a ton of information <a href="https://jpcertcc.github.io/ToolAnalysisResultSheet/details/mstsc.htm">here</a>, I just can’t quite decipher or discern the clear order of events and some appear out of order (at least how I have encountered them, but maybe I’m reading it wrong…). At any rate, as they say, <a href="https://www.youtube.com/watch?v=GWABFikdVcg">necessity is the mother of invention</a>.</p>
<p>So, I decided to create a blog post that I hope can serve as a succinct one-stop shop for understanding and identifying the most commonly encountered and empirically useful* RDP-related Windows Event Log ID’s/entries for tracking and investigating RDP usage on a Windows Vista+ endpoint. The Windows Event ID’s in the XP days were different than those in Vista+ Operating Systems. So, I decided to leave those out for now, but perhaps I will add them in the future.</p>
<p>*Yes, there are Event ID’s like <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/ee891120%28v%3dws.10%29">1146</a>, <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/ee891219%28v%3dws.10%29">1147</a>, and <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/ee890875%28v%3dws.10%29">1148</a> which look great in Microsoft’s documentation as a very useful source of information. However, I’ve yet to see (m)any of these commonly occurring in the wild.</p>
<p>I debated back and forth on the best way to sort/group these. Ultimately, in truly pragmatic fashion, I figured it would likely be most useful to sort them in the (chronological) order in which you might expect to find them. Ergo, the flow/section breakup is the following:</p>
<h5>Network Connection</h5>
<h5 style="padding-left: 30px;">-&gt;-&gt; Authentication</h5>
<h5 style="padding-left: 60px;">-&gt;-&gt; Logon</h5>
<h5 style="padding-left: 90px;">-&gt;-&gt; Session Disconnect/Reconnect</h5>
<h5 style="padding-left: 120px;">-&gt;-&gt; Logoff</h5>
<h2><span style="text-decoration: underline;">Network Connection</span></h2>
<p>This section covers the first indications of an RDP logon – the initial network connection to a machine.</p>
<h4>Log: Microsoft-Windows-Terminal-Services-RemoteConnectionManager/Operational</h4>
<p><strong>Log Location:</strong> %SystemRoot%\System32\Winevt\Logs\Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational.evtx</p>
<p><strong>Event ID:</strong> 1149<br>
<strong>Provider Name:</strong> Microsoft-Windows-Terminal-Services-RemoteConnectionManager<br>
<strong>Description:</strong> “User authentication succeeded”<br>
<strong>Notes:</strong> Despite this seemingly clear-cut description, this event actually DOES NOT indicate a successful user authentication in the sense that many might expect (e.g., successful input and acceptance of a username and password). Instead, “authentication” in this sense is referring to successful network authentication, as in someone successfully executed an RDP network connection to the target machine and it successfully responded and displayed a login window for the next step of entering credentials. For example, if I launched the RDP Desktop Connection program on my computer, input a target IP, and hit enter, it would simply display the target system’s screen and produce an 1149 Event ID indicating I had successfully connected to the target, WELL BEFORE I even entered any credentials. So, repeat after me, <span style="text-decoration: underline;"><em>“An Event ID 1149 DOES NOT indicate successful authentication to a target, simply a successful RDP network connection”</em></span>.<br>
<strong>TL;DR:</strong> NOT AN AUTHENTICATION. Someone launched an RDP client, specified the target machine (possibly with a username and domain), and hit enter to make a successful network connection to the target. Nothing more, nothing less.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-276" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/1149.png" alt="" width="970" height="595" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/1149.png 970w, https://ponderthebits.com/wp-content/uploads/2018/02/1149-300x184.png 300w, https://ponderthebits.com/wp-content/uploads/2018/02/1149-768x471.png 768w, https://ponderthebits.com/wp-content/uploads/2018/02/1149-900x552.png 900w" sizes="(max-width: 970px) 100vw, 970px"><br>
<img loading="lazy" class="alignnone size-full wp-image-277" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/1149_XML.png" alt="" width="968" height="603" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/1149_XML.png 968w, https://ponderthebits.com/wp-content/uploads/2018/02/1149_XML-300x187.png 300w, https://ponderthebits.com/wp-content/uploads/2018/02/1149_XML-768x478.png 768w, https://ponderthebits.com/wp-content/uploads/2018/02/1149_XML-900x561.png 900w" sizes="(max-width: 968px) 100vw, 968px"></p>
<h2><span style="text-decoration: underline;">Authentication</span></h2>
<p>This section covers the authentication portion of the RDP connection – whether or not the logon is allowed based on success/failure of username/password combo.</p>
<h4>Log: Security</h4>
<p><strong>Log Location:</strong> %SystemRoot%\System32\Winevt\Logs\Security.evtx</p>
<p><strong>Event ID:</strong> <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4624">4624</a><br>
<strong>Provider Name:</strong> Microsoft-Windows-Security-Auditing<br>
<strong>LogonType:</strong> Type 3 (Network) when <a href="https://en.wikipedia.org/wiki/Network_Level_Authentication">NLA</a> is Enabled (and at times even when it’s not) followed by Type 10 (RemoteInteractive / a.k.a. Terminal Services / a.k.a. Remote Desktop) <span style="text-decoration: underline;"><em>OR</em></span> Type 7 from a Remote IP (if it’s a reconnection from a previous/existing RDP session)<br>
<strong>Description:</strong> “An account was successfully logged on”<br>
<strong>Notes:</strong> I thought this one was pretty straight forward – just look for Type 10 logons for RDP. However, in a bit more research, I discovered that often a Type 3 logon (for NLA) will occur prior to the Type 10 logon. In addition, I also discovered that RDP’ing to a system of which you’d previously RDP’ed and not formally logged off/out would instead yield a Logon Type 7 logon versus the Logon Type 10 we’d expect. This makes sense in a way in that a Logon Type 7 (“This workstation was unlocked”) is essentially what is happening. However, to delineate this from non-RDP Type 7 logons in which a person was sitting at the machine and just unlocked the machine, we can look for remote non-local IP’s in the IpAddress field.<br>
<strong>TL;DR:</strong> User successfully logged on to this system with the specified <em>TargetUserName</em> and <em>TargetDomainName</em> from the specified <em>IpAddress</em>.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-279" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/4624.png" alt="" width="999" height="968" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/4624.png 999w, https://ponderthebits.com/wp-content/uploads/2018/02/4624-300x291.png 300w, https://ponderthebits.com/wp-content/uploads/2018/02/4624-768x744.png 768w, https://ponderthebits.com/wp-content/uploads/2018/02/4624-900x872.png 900w" sizes="(max-width: 999px) 100vw, 999px"><br>
<img loading="lazy" class="alignnone size-full wp-image-280" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/4624_XML.png" alt="" width="990" height="958" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/4624_XML.png 990w, https://ponderthebits.com/wp-content/uploads/2018/02/4624_XML-300x290.png 300w, https://ponderthebits.com/wp-content/uploads/2018/02/4624_XML-768x743.png 768w, https://ponderthebits.com/wp-content/uploads/2018/02/4624_XML-900x871.png 900w" sizes="(max-width: 990px) 100vw, 990px"></p>
<p><strong>Event ID:</strong> <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4625">4625</a><br>
<strong>Provider Name:</strong> Microsoft-Windows-Security-Auditing<br>
<strong>LogonType:</strong> Type 3 (Network) when <a href="https://en.wikipedia.org/wiki/Network_Level_Authentication">NLA</a> is Enabled (and at times even when it’s not) <span style="text-decoration: underline;"><em>and/or</em></span> Type 10 (RemoteInteractive / a.k.a. Terminal Services / a.k.a. Remote Desktop)<br>
<strong>Description:</strong> “An account failed to log on”<br>
<strong>Notes:</strong> Why do we care about failures? Well, this is helpful in identifying (brute force) failure attempts and seeing when/where an attacker may be attempting stolen/compromised credentials. The Status/Sub Status Code will also be helpful in delineating legitimate failures (e.g. “expired password”) as well as possibly providing insight into attacker activity (e.g. repetitive “user name does not exist” codes could indicate brute force guessing by a tool and/or a more targeted lack of username knowledge/awareness in the environment by the attacker).<br>
<strong>TL;DR:</strong> User failed to log on to this system with the specified TargetUserName and TargetDomainName from the specified IpAddress.</p>
<p><img loading="lazy" class="alignnone wp-image-415 size-full" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/4625_Type3.png" alt="" width="1240" height="852" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/4625_Type3.png 1240w, https://ponderthebits.com/wp-content/uploads/2018/02/4625_Type3-300x206.png 300w, https://ponderthebits.com/wp-content/uploads/2018/02/4625_Type3-768x528.png 768w, https://ponderthebits.com/wp-content/uploads/2018/02/4625_Type3-1024x704.png 1024w, https://ponderthebits.com/wp-content/uploads/2018/02/4625_Type3-900x618.png 900w" sizes="(max-width: 1240px) 100vw, 1240px"></p>
<p><img loading="lazy" class="alignnone size-full wp-image-416" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/4625_Type3_XML.png" alt="" width="1242" height="843" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/4625_Type3_XML.png 1242w, https://ponderthebits.com/wp-content/uploads/2018/02/4625_Type3_XML-300x204.png 300w, https://ponderthebits.com/wp-content/uploads/2018/02/4625_Type3_XML-768x521.png 768w, https://ponderthebits.com/wp-content/uploads/2018/02/4625_Type3_XML-1024x695.png 1024w, https://ponderthebits.com/wp-content/uploads/2018/02/4625_Type3_XML-900x611.png 900w" sizes="(max-width: 1242px) 100vw, 1242px"></p>
<p><strong>#ProTip(s):</strong></p>
<p>1) When NLA is enabled, a failed RDP logon (due to wrong username, password, etc.) will result in a 4625 Type 3 failure. When NLA is not enabled, you *should* see a 4625 Type 10 failure.</p>
<p>2) Both of these entries also contain a “SubjectLogonID” or a “TargetLogonID” field. This ID is unique for each logon session and is also present in various other Event Log entries, making it theoretically useful for tracking/delineating a specific user’s activities, particularly on systems allowing multiple logged on users. However, do take note that a unique *LogonID is assigned for each session, meaning if a user connects, then disconnects (without logging out, thus simply ending the current session), then reconnects (i.e. starting a new session), they will be assigned a different unique *LogonID. All to say that a single user(name) may have multiple unique *LogonID’s to track depending how many sessions they’ve instantiated, not to mention Windows makes it very confusing sometimes with multiple 4624’s with different *LogonID’s for the same session. So, YMMV.</p>
<p><strong>Additional References:</strong></p>
<p>David Cowen’s Forensic Lunch Test Kitchen – RDP Testing (<a href="https://www.hecfblog.com/2018/10/daily-blog-516-forensic-lunch-test.html">1</a> , <a href="https://www.hecfblog.com/2018/10/daily-blog-517-forensic-lunch-test.html">2</a> , <a href="https://www.hecfblog.com/2018/10/daily-blog-518-forensic-lunch-test.html">3</a>)<br>
Microsoft Forum Answer Re: RDP 4624 Type 3 Logons (<a href="https://social.technet.microsoft.com/Forums/en-US/1fa214d7-e8b6-4d77-adda-117926aa9e6f/event-4624-logon-type-3-for-rdp-access-?forum=winserverDS">link</a>)</p>
<h2><span style="text-decoration: underline;">Logon</span></h2>
<p>This section covers the ensuing (post-authentication) events that occur upon successful authentication and logon to the system.</p>
<h4>Log: Microsoft-Windows-TerminalServices-LocalSessionManager/Operational</h4>
<p><strong>Log Location:</strong> %SystemRoot%\System32\Winevt\Logs\Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational.evtx</p>
<p><strong>Event ID:</strong> 21<br>
<strong>Provider Name:</strong> Microsoft-Windows-TerminalServices-LocalSessionManager<br>
<strong>Description:</strong> “Remote Desktop Services: Session logon succeeded:”<br>
<strong>Notes:</strong> This typically immediately precedes an Event ID 22 when the “Source Network Address” contains a remote IP address. Note that a “Source Network Address” of “LOCAL” simply indicates a local logon and <span style="text-decoration: underline;"><em>does NOT</em></span> indicate a remote RDP logon. this event with a “Source Network Address” of “LOCAL” will also be generated upon system (re)boot/initialization (shortly before the proceeding associated Event ID 22) . For remote RDP logons, take note of the SessionID as a means of tracking/associating additional Event Log activity with this user’s RDP session.<br>
<strong>TL;DR:</strong> Indicates successful RDP logon and session instantiation, so long as the “Source Network Address” <span style="text-decoration: underline;"><em>is NOT</em></span> “LOCAL”.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-370" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/21.png" alt="" width="517" height="631" srcset="https://ponderthebits.com/wp-content/uploads/2018/08/21.png 517w, https://ponderthebits.com/wp-content/uploads/2018/08/21-246x300.png 246w" sizes="(max-width: 517px) 100vw, 517px"></p>
<p><img loading="lazy" class="alignnone size-full wp-image-371" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/21_XML.png" alt="" width="755" height="658" srcset="https://ponderthebits.com/wp-content/uploads/2018/08/21_XML.png 755w, https://ponderthebits.com/wp-content/uploads/2018/08/21_XML-300x261.png 300w" sizes="(max-width: 755px) 100vw, 755px"></p>
<p><strong>Event ID:</strong> 22<br>
<strong>Provider Name:</strong> Microsoft-Windows-TerminalServices-LocalSessionManager<br>
<strong>Description:</strong> “Remote Desktop Services: Shell start notification received:”<br>
<strong>Notes:</strong> This typically immediately proceeds an Event ID 21. Note that a&nbsp;“Source Network Address” of “LOCAL” simply indicates a local logon and <span style="text-decoration: underline;"><em>does NOT</em></span> indicate a remote RDP logon. This event with a “Source Network Address” of “LOCAL” will also be generated upon system (re)boot/initialization (shortly after the preceding associated Event ID 21).<br>
<strong>TL;DR:</strong> Indicates successful RDP logon and shell (i.e. Windows GUI Desktop) start,&nbsp;so long as the “Source Network Address” <span style="text-decoration: underline;"><em>is NOT</em></span> “LOCAL”.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-372" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/22.png" alt="" width="515" height="632" srcset="https://ponderthebits.com/wp-content/uploads/2018/08/22.png 515w, https://ponderthebits.com/wp-content/uploads/2018/08/22-244x300.png 244w" sizes="(max-width: 515px) 100vw, 515px"></p>
<p><img loading="lazy" class="alignnone size-full wp-image-373" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/22_XML.png" alt="" width="753" height="655" srcset="https://ponderthebits.com/wp-content/uploads/2018/08/22_XML.png 753w, https://ponderthebits.com/wp-content/uploads/2018/08/22_XML-300x261.png 300w" sizes="(max-width: 753px) 100vw, 753px"></p>
<h2><span style="text-decoration: underline;">Session Disconnect/Reconnect</span></h2>
<p>This section covers the various session disconnect/reconnect events that might occur due to either system (idle), network (network disconnect), or purposeful user (X out of the RDP window, Start -&gt; Disconnect, Kicked off by another user, etc.) action.</p>
<h4>Log: Microsoft-Windows-TerminalServices-LocalSessionManager/Operational</h4>
<p><strong>Log Location:</strong> %SystemRoot%\System32\Winevt\Logs\Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational.evtx</p>
<p><strong>Event ID:</strong> 24<br>
<strong>Provider Name:</strong> Microsoft-Windows-TerminalServices-LocalSessionManager<br>
<strong>Description:</strong> “Remote Desktop Services: Session has been disconnected:”<br>
<strong>Notes:</strong> The user has disconnected from an RDP session, when the “Source Network Address” contains a remote IP address.&nbsp;A “Source Network Address” of “LOCAL” simply indicates a local session disconnection and <span style="text-decoration: underline;"><em>does NOT</em></span> indicate a remote RDP disconnection. Note the “Source Network Address” for the source of the RDP connection. This is typically paired with an Event ID 40. Also take note of the SessionID as a means of tracking/associating additional Event Log activity with this user’s RDP session.<br>
<strong>TL;DR:</strong> The user has disconnected from an RDP session,&nbsp;so long as the “Source Network Address” <span style="text-decoration: underline;"><em>is NOT</em></span> “LOCAL”.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-289" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/24.png" alt="" width="532" height="578" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/24.png 532w, https://ponderthebits.com/wp-content/uploads/2018/02/24-276x300.png 276w" sizes="(max-width: 532px) 100vw, 532px"><br>
<img loading="lazy" class="alignnone size-full wp-image-290" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/24_XML.png" alt="" width="1057" height="577" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/24_XML.png 1057w, https://ponderthebits.com/wp-content/uploads/2018/02/24_XML-300x164.png 300w, https://ponderthebits.com/wp-content/uploads/2018/02/24_XML-768x419.png 768w, https://ponderthebits.com/wp-content/uploads/2018/02/24_XML-1024x559.png 1024w, https://ponderthebits.com/wp-content/uploads/2018/02/24_XML-900x491.png 900w" sizes="(max-width: 1057px) 100vw, 1057px"></p>
<p><strong>Event ID:</strong> 25<br>
<strong>Provider Name:</strong> Microsoft-Windows-TerminalServices-LocalSessionManager<br>
<strong>Description:</strong> “Remote Desktop Services: Session reconnection succeeded:”<br>
<strong>Notes:</strong> The user has reconnected to an RDP session, when the “Source Network Address” contains a remote IP address.&nbsp;A “Source Network Address” of “LOCAL” simply indicates a local session reconnection and <span style="text-decoration: underline;"><em>does NOT</em></span> indicate a remote RDP session reconnection. Note the “Source Network Address” for the source of the RDP connection. This is typically paired with an Event ID 40. Take note of the SessionID as a means of tracking/associating additional Event Log activity with this user’s RDP session.<br>
<strong>TL;DR:</strong> The user has reconnected to an existing RDP session,&nbsp;so long as the “Source Network Address” <span style="text-decoration: underline;"><em>is NOT</em></span> “LOCAL”.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-291" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/25.png" alt="" width="529" height="578" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/25.png 529w, https://ponderthebits.com/wp-content/uploads/2018/02/25-275x300.png 275w" sizes="(max-width: 529px) 100vw, 529px"><br>
<img loading="lazy" class="alignnone size-full wp-image-292" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/25_XML.png" alt="" width="1059" height="575" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/25_XML.png 1059w, https://ponderthebits.com/wp-content/uploads/2018/02/25_XML-300x163.png 300w, https://ponderthebits.com/wp-content/uploads/2018/02/25_XML-768x417.png 768w, https://ponderthebits.com/wp-content/uploads/2018/02/25_XML-1024x556.png 1024w, https://ponderthebits.com/wp-content/uploads/2018/02/25_XML-900x489.png 900w" sizes="(max-width: 1059px) 100vw, 1059px"></p>
<p><strong>Event ID:</strong> 39<br>
<strong>Provider Name:</strong> Microsoft-Windows-TerminalServices-LocalSessionManager<br>
<strong>Description:</strong> “Session &lt;X&gt; has been disconnected by session &lt;Y&gt;”<br>
<strong>Notes:</strong> This indicates that a user has formally disconnected from an RDP session via purposeful Disconnect (e.g., via the Windows Start Menu Disconnect option) versus simply X’ing out of the RDP window. Cases where the Session ID of &lt;X&gt; differs from &lt;Y&gt; may indicate a separate RDP session has disconnected (i.e. kicked off) the given user.<br>
<strong>TL;DR:</strong> The user formally disconnected from the RDP session.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-293" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/39.png" alt="" width="526" height="575" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/39.png 526w, https://ponderthebits.com/wp-content/uploads/2018/02/39-274x300.png 274w" sizes="(max-width: 526px) 100vw, 526px"><br>
<img loading="lazy" class="alignnone size-full wp-image-294" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/39_XML.png" alt="" width="1055" height="576" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/39_XML.png 1055w, https://ponderthebits.com/wp-content/uploads/2018/02/39_XML-300x164.png 300w, https://ponderthebits.com/wp-content/uploads/2018/02/39_XML-768x419.png 768w, https://ponderthebits.com/wp-content/uploads/2018/02/39_XML-1024x559.png 1024w, https://ponderthebits.com/wp-content/uploads/2018/02/39_XML-900x491.png 900w" sizes="(max-width: 1055px) 100vw, 1055px"></p>
<p><strong>Event ID:</strong> 40<br>
<strong>Provider Name:</strong> Microsoft-Windows-TerminalServices-LocalSessionManager<br>
<strong>Description:</strong> “Session &lt;X&gt; has been disconnected, reason code &lt;Z&gt;”<br>
<strong>Notes:</strong> In true Microsoft fashion, although the description is always “Session has been disconnected”, these events also indicate/correlate to reconnections, not just disconnections. The most helpful information here is the Reason Code (a function of the <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa381339(v=vs.85).aspx">IMsRdpClient::ExtendedDisconnectReason property</a>), the list of which can be seen <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/mt786980(v=vs.85).aspx">here</a> (and <a href="https://community.spiceworks.com/topic/764914-remote-desktop-services-disconnect-code?page=1#entry-5456587">this</a> pairs it with the codes to make it easier to read). Below are some examples of codes I encountered during my research.<br>
0 – “No additional information is available.” (Occurs when a user informally X’es out of a session, typically paired with Event ID 24)<br>
5 – “The client’s connection was replaced by another connection.” (Occurs when a user reconnects to an RDP session, typically paired with an Event ID 25)<br>
11 – “User activity has initiated the disconnect.” (Occurs when a user formally initiates an RDP disconnect, for example via the Windows Start Menu Disconnect option.)<br>
<strong>TL;DR:</strong> The user disconnected from or reconnected to an RDP session.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-295" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/40.png" alt="" width="522" height="576" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/40.png 522w, https://ponderthebits.com/wp-content/uploads/2018/02/40-272x300.png 272w" sizes="(max-width: 522px) 100vw, 522px"><br>
<img loading="lazy" class="alignnone size-full wp-image-296" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/40_XML.png" alt="" width="1051" height="577" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/40_XML.png 1051w, https://ponderthebits.com/wp-content/uploads/2018/02/40_XML-300x165.png 300w, https://ponderthebits.com/wp-content/uploads/2018/02/40_XML-768x422.png 768w, https://ponderthebits.com/wp-content/uploads/2018/02/40_XML-1024x562.png 1024w, https://ponderthebits.com/wp-content/uploads/2018/02/40_XML-900x494.png 900w" sizes="(max-width: 1051px) 100vw, 1051px"></p>
<h4>Log: Security</h4>
<p><strong>Log Location:</strong> %SystemRoot%\System32\Winevt\Logs\Security.evtx</p>
<p><strong>Event ID:</strong> <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4778">4778</a><br>
<strong>Provider Name:</strong> Microsoft-Windows-Security-Auditing<br>
<strong>Description:</strong> “A session was reconnected to a Window Station.”<br>
<strong>Notes:</strong> Occurs when a user reconnects to an existing RDP session. Typically paired with Event ID 25. The SessionName, ClientAddress, and LogonID can all be useful for identifying the source and associated activity.<br>
<strong>TL;DR:</strong> The user reconnected to an existing RDP session.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-304" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/4778.png" alt="" width="399" height="414" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/4778.png 399w, https://ponderthebits.com/wp-content/uploads/2018/02/4778-289x300.png 289w" sizes="(max-width: 399px) 100vw, 399px"><br>
<img loading="lazy" class="alignnone size-full wp-image-305" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/4778_XML.png" alt="" width="819" height="497" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/4778_XML.png 819w, https://ponderthebits.com/wp-content/uploads/2018/02/4778_XML-300x182.png 300w, https://ponderthebits.com/wp-content/uploads/2018/02/4778_XML-768x466.png 768w" sizes="(max-width: 819px) 100vw, 819px"></p>
<p><strong>Event ID:</strong> <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4779">4779</a><br>
<strong>Provider Name:</strong> Microsoft-Windows-Security-Auditing<br>
<strong>Description:</strong> “A session was disconnected from a Window Station.”<br>
<strong>Notes:</strong> Occurs when a user disconnects from an RDP session. Typically paired with Event ID 24 and likely Event ID’s 39 and 40. The SessionName, ClientAddress, and LogonID can all be useful for identifying the source and associated activity.<br>
<strong>TL;DR:</strong> The user disconnected from from an RDP session.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-306" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/4779.png" alt="" width="397" height="428" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/4779.png 397w, https://ponderthebits.com/wp-content/uploads/2018/02/4779-278x300.png 278w" sizes="(max-width: 397px) 100vw, 397px"><br>
<img loading="lazy" class="alignnone size-full wp-image-307" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/4779_XML.png" alt="" width="820" height="496" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/4779_XML.png 820w, https://ponderthebits.com/wp-content/uploads/2018/02/4779_XML-300x181.png 300w, https://ponderthebits.com/wp-content/uploads/2018/02/4779_XML-768x465.png 768w" sizes="(max-width: 820px) 100vw, 820px"></p>
<h2><span style="text-decoration: underline;">Logoff</span></h2>
<p>This section covers the events that occur after a purposeful (Start -&gt; Disconnect, Start -&gt; Logoff) logoff.</p>
<h4>Log: Microsoft-Windows-TerminalServices-LocalSessionManager/Operational</h4>
<p><strong>Log Location:</strong> %SystemRoot%\System32\Winevt\Logs\Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational.evtx</p>
<p><strong>Event ID:</strong> 23<br>
<strong>Provider Name:</strong> Microsoft-Windows-TerminalServices-LocalSessionManager<br>
<strong>Description:</strong> “Remote Desktop Services: Session logoff succeeded:”<br>
<strong>Notes:</strong> The user has initiated a logoff. This is typically paired with an Event ID 4634 (logoff). Take note of the SessionID as a means of tracking/associating additional Event Log activity with this user’s RDP session. This event with a will also be generated upon a system shutdown/reboot.<br>
<strong>TL;DR:</strong> The user initiated a formal system logoff (versus a simple session disconnect).</p>
<p><img loading="lazy" class="alignnone size-full wp-image-297" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/23.png" alt="" width="532" height="575" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/23.png 532w, https://ponderthebits.com/wp-content/uploads/2018/02/23-278x300.png 278w" sizes="(max-width: 532px) 100vw, 532px"><br>
<img loading="lazy" class="alignnone size-full wp-image-298" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/23_XML.png" alt="" width="1055" height="576" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/23_XML.png 1055w, https://ponderthebits.com/wp-content/uploads/2018/02/23_XML-300x164.png 300w, https://ponderthebits.com/wp-content/uploads/2018/02/23_XML-768x419.png 768w, https://ponderthebits.com/wp-content/uploads/2018/02/23_XML-1024x559.png 1024w, https://ponderthebits.com/wp-content/uploads/2018/02/23_XML-900x491.png 900w" sizes="(max-width: 1055px) 100vw, 1055px"></p>
<h4>Log: Security</h4>
<p><strong>Log Location:</strong> %SystemRoot%\System32\Winevt\Logs\Security.evtx</p>
<p><strong>Event ID:</strong> <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4634">4634</a><br>
<strong>Provider Name:</strong> Microsoft-Windows-Security-Auditing<br>
<strong>LogonType:</strong> 10 (RemoteInteractive / a.k.a. Terminal Services / a.k.a. Remote Desktop) OR Type 7 from a Remote IP (if it’s a reconnection from a previous/existing RDP session)<br>
<strong>Description:</strong> “An account was logged off.”<br>
<strong>Notes:</strong> These occur whenever a user simply disconnects from an RDP session or formally logs off (via Windows Start Menu Logoff). This is typically paired with an Event ID 21 (RDP Session Logoff). I’ve also discovered these will also be paired (i.e. occur at the same time) with successful authentications (Event ID 4624). Why, I have no idea.<br>
<strong>TL;DR:</strong> A user disconnected from, or logged off, an RDP session.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-299" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/4634.png" alt="" width="400" height="354" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/4634.png 400w, https://ponderthebits.com/wp-content/uploads/2018/02/4634-300x266.png 300w" sizes="(max-width: 400px) 100vw, 400px"><br>
<img loading="lazy" class="alignnone size-full wp-image-300" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/4634_XML.png" alt="" width="823" height="479" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/4634_XML.png 823w, https://ponderthebits.com/wp-content/uploads/2018/02/4634_XML-300x175.png 300w, https://ponderthebits.com/wp-content/uploads/2018/02/4634_XML-768x447.png 768w" sizes="(max-width: 823px) 100vw, 823px"></p>
<p><strong>Event ID:</strong> <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4647">4647</a><br>
<strong>Provider Name:</strong> Microsoft-Windows-Security-Auditing<br>
<strong>Description:</strong> “User initiated logoff:”<br>
<strong>Notes:</strong> Occurs when a user initiates a formal system logoff and is not necessarily RDP specific. You will need to use some reasoning and temporal analysis to understand if/when it is related to a system logoff via an RDP session or is from a local interactive session as there is no LogonType associated specify which it is.<br>
<strong>TL;DR:</strong> The user initiated a formal logoff (NOT a simple disconnect).</p>
<p><img loading="lazy" class="alignnone size-full wp-image-302" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/4647.png" alt="" width="400" height="315" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/4647.png 400w, https://ponderthebits.com/wp-content/uploads/2018/02/4647-300x236.png 300w" sizes="(max-width: 400px) 100vw, 400px"><br>
<img loading="lazy" class="alignnone size-full wp-image-303" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/4647_XML.png" alt="" width="821" height="455" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/4647_XML.png 821w, https://ponderthebits.com/wp-content/uploads/2018/02/4647_XML-300x166.png 300w, https://ponderthebits.com/wp-content/uploads/2018/02/4647_XML-768x426.png 768w" sizes="(max-width: 821px) 100vw, 821px"></p>
<h4>Log: System</h4>
<p><strong>Log Location:</strong> %SystemRoot%\System32\Winevt\Logs\System.evtx</p>
<p><strong>Event ID:</strong> 9009<br>
<strong>Provider Name:</strong> Desktop Window Manager<br>
<strong>Description:</strong> “The Desktop Window Manager has exited with code (&lt;X&gt;).”<br>
<strong>Notes:</strong> Occurs when a user formally closes an RDP connection and indicates the RDP desktop GUI has been shut down as a result. This is useful to identify a closed/finalized RDP connection. Though, this event is not always produced for reasons I do not know.<br>
<strong>TL;DR:</strong> A user has closed out an RDP connection.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-308" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/9009.png" alt="" width="570" height="346" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/9009.png 570w, https://ponderthebits.com/wp-content/uploads/2018/02/9009-300x182.png 300w" sizes="(max-width: 570px) 100vw, 570px"><br>
<img loading="lazy" class="alignnone size-full wp-image-309" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/9009_XML.png" alt="" width="451" height="441" srcset="https://ponderthebits.com/wp-content/uploads/2018/02/9009_XML.png 451w, https://ponderthebits.com/wp-content/uploads/2018/02/9009_XML-300x293.png 300w" sizes="(max-width: 451px) 100vw, 451px"></p>
<h2>Wrap-Up</h2>
<p>Hopefully that provides a little better insight into some of the most common and (IME) most empirically useful RDP-related Event logs, when/where you might encounter them, what they mean, what they look like, and (most importantly) how they all fit together.</p>
<p>As a result of this post, Richard Davis (<a href="https://twitter.com/davisrichardg">@richarddavisg</a>, <a href="https://twitter.com/13CubedDFIR">@13CubedDFIR</a>) of <a href="https://www.youtube.com/13cubed">13Cubed on YouTube</a> has also put together an <a href="https://www.13cubed.com/downloads/rdp_flowchart.pdf">RDP flow chart</a> that is very helpful in visualizing the expected (though, not guaranteed) flow of these logs. Feel free to check out his short <a href="https://www.youtube.com/watch?v=myzG11BP3Sk">video walkthrough</a> as well.</p>

								</div><!-- .post-content -->

								
						</div><!-- .post-inner -->

						
								<div class="post-navigation">
									<div class="post-navigation-inner group">

																					<div class="post-nav-prev">
												<p>Previous</p>
												<h4><a href="https://ponderthebits.com/2018/02/generating-file-system-listings-from-the-command-line-with-full-macb-timestamps-and-hashes/">Generating File System Listings from the Command Line (with Full MACB Timestamps and Hashes)</a></h4>
											</div>
																				
										
									</div><!-- .post-navigation-inner -->
								</div><!-- .post-navigation -->

								
	<div class="comments-container">

		<div class="comments-inner">

			<a name="comments"></a>

			<div class="comments-title-container group">

				<h2 class="comments-title">

					51 Comments
				</h2>

									<p class="comments-title-link"><a href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#respond">Add Comment →</a></p>
				
			</div><!-- .comments-title-container -->

			<div class="comments">

				<ol class="commentlist">
					
			<li class="comment even thread-even depth-1" id="li-comment-49">

				<div id="comment-49" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/923d10bc97028030e8e67e7db62658d1.png" srcset="https://secure.gravatar.com/avatar/923d10bc97028030e8e67e7db62658d1?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>RDP</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Thank you for putting the effort into this and sharing with the community. Only one ask. When doing an RDP from the source as windows to the destination, please also add, to the above, where will the documented log be found, on the source or on the destination.</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-49">March 3, 2018</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=49#respond" data-commentid="49" data-postid="275" data-belowelement="comment-49" data-respondelement="respond" data-replyto="Reply to RDP" aria-label="Reply to RDP">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-2" id="li-comment-50">

				<div id="comment-50" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-50">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Thanks for the feedback. That’s a great question. All of the Event ID’s referenced in this post will be found within the logs on the target system (the endpoint that is receiving the remote RDP connection). </p>
<p>Historically, the main artifact on a source system (the system connecting to another system via RDP) was a prefetch entry for mstsc.exe (the RDP client executable) – namely MSTSC.EXE-462193BE.pf. However, I’ve recently discovered another source of Event ID’s that provide indication and information on RDP connections to other systems. These events lie within the Microsoft-Windows-TerminalServices-RDPClient/Operational log (location on disk is %SystemRoot%\System32\Winevt\Logs\Microsoft-Windows-TerminalServices-RDPClient%4Operational.evtx). When a source machine attempts to connect to a target, various Event ID’s are logged here indicating the name/IP of the target as well as various related connection and disconnection messages which can also be helpful when investigating a system that is the source of RDP connections to other machines. </p>
<p>Perhaps I will do another short write-up on that at some point in the future, or will send it out to the community and see if someone else has time to do so.</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-50">March 3, 2018</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=50#respond" data-commentid="50" data-postid="275" data-belowelement="comment-50" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment even thread-odd thread-alt depth-1" id="li-comment-51">

				<div id="comment-51" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/fc69e3e1a4de0bcaf52aebea3774afc8.png" srcset="https://secure.gravatar.com/avatar/fc69e3e1a4de0bcaf52aebea3774afc8?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://symmetric.co.nz/" rel="external nofollow ugc" class="url">Symmetric</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Thanks for expanding on this. I always  jump to event id 4625 as a matter of routine, you’ll see multiple failed attempts on this ID if the bad guys are trying to brute force a password on your server. Changing your RDP listening port significantly cuts out the ‘noise’ from the internet. <img draggable="false" role="img" class="emoji" alt="🙂" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/1f642.svg"></p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-51">March 7, 2018</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=51#respond" data-commentid="51" data-postid="275" data-belowelement="comment-51" data-respondelement="respond" data-replyto="Reply to Symmetric" aria-label="Reply to Symmetric">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-2" id="li-comment-52">

				<div id="comment-52" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-52">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Glad I could help <img draggable="false" role="img" class="emoji" alt="🙂" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/1f642.svg"></p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-52">March 7, 2018</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=52#respond" data-commentid="52" data-postid="275" data-belowelement="comment-52" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment even thread-even depth-1" id="li-comment-53">

				<div id="comment-53" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/9185b9c86005b1ea298d272a4bca79b1.png" srcset="https://secure.gravatar.com/avatar/9185b9c86005b1ea298d272a4bca79b1?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Loumos</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Nice job ! Very usefull ! Maybe you should talk about NLA authentication which change RDP logon tracking.<br>
I also try to clarify simple login for SIEM investigation : when à user authenticate to an AD. I could help you for this part let me know ! <img draggable="false" role="img" class="emoji" alt="🙂" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/1f642.svg"></p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-53">March 11, 2018</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=53#respond" data-commentid="53" data-postid="275" data-belowelement="comment-53" data-respondelement="respond" data-replyto="Reply to Loumos" aria-label="Reply to Loumos">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-2" id="li-comment-54">

				<div id="comment-54" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-54">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Thanks! This post focuses on RDP using NLA Authentication. It doesn’t cover what would be logged at the AD for Kerberos or other authentication types as that’s out of scope for the focus here (identifying/parsing event logs on the endpoints/workstations). Do feel free to do a writeup on the AD aspect, though, as that could also be helpful.</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-54">March 11, 2018</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=54#respond" data-commentid="54" data-postid="275" data-belowelement="comment-54" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment even thread-odd thread-alt depth-1" id="li-comment-55">

				<div id="comment-55" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/cbed1ea5cb1996e672c9dd898996cde3.png" srcset="https://secure.gravatar.com/avatar/cbed1ea5cb1996e672c9dd898996cde3?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Joe</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Great write up Jonathon!<br>
Is there a free tool that aggregates all the windows event logs to display the chain of events?</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-55">March 20, 2018</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=55#respond" data-commentid="55" data-postid="275" data-belowelement="comment-55" data-respondelement="respond" data-replyto="Reply to Joe" aria-label="Reply to Joe">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-2" id="li-comment-56">

				<div id="comment-56" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-56">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Thanks! There are a few different tools you can use, each with varying levels of effort/involvement. The most popular and straight forward (once installed) tool is probably Plaso’s Log2timeline (<a href="https://github.com/log2timeline/plaso" rel="nofollow ugc">https://github.com/log2timeline/plaso</a>) as it has binaries available for Windows, Linux, and Mac. You can simply extract all Windows event logs into a single folder and point log2timeline at the folder with the appropriate parser (winevt or winevtx) and let it rip. In the end (after running psort to output into a CSV or whatever file output type you like) you’ll have all* the processed Windows event logs in human readable form. </p>
<p>*Plaso/Log2timeline has been known to have sporadic issues parsing things, so… caveat emptor.</p>
<p>If you’re less comfortable in Linux or with the command line, Microsoft also has some great tools for parsing event logs called Log Parser (<a href="https://technet.microsoft.com/en-us/scriptcenter/dd919274.aspx" rel="nofollow ugc">https://technet.microsoft.com/en-us/scriptcenter/dd919274.aspx</a>), along with a “Studio” version (<a href="https://gallery.technet.microsoft.com/office/Log-Parser-Studio-cd458765" rel="nofollow ugc">https://gallery.technet.microsoft.com/office/Log-Parser-Studio-cd458765</a>) with some additional GUI bells and whistles. There is also another tool called Log Parser Lizard (<a href="https://lizard-labs.com/log_parser_lizard.aspx" rel="nofollow ugc">https://lizard-labs.com/log_parser_lizard.aspx</a>) which is another free GUI tool for Windows to parse event logs.</p>
<p>At any rate, I could probably write an entire blog post itself on various ways to parse those logs, but hope the above helps!</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-56">March 20, 2018</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=56#respond" data-commentid="56" data-postid="275" data-belowelement="comment-56" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment even thread-even depth-1" id="li-comment-61">

				<div id="comment-61" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/6902ea19f6b82c8a8bbe7ed8300de736.png" srcset="https://secure.gravatar.com/avatar/6902ea19f6b82c8a8bbe7ed8300de736?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Jason</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi,</p>
<p>This blog is awesome! </p>
<p>I trying to replicate 1149 (connection without authentication) however I can only get this log when RDP is successfully authenticated. I have also tried using a different RDP client. Both machines are Windows 10. Seems to be only logging an event with ID 261</p>
<p>Can you confirm your setup?</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-61">July 16, 2018</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=61#respond" data-commentid="61" data-postid="275" data-belowelement="comment-61" data-respondelement="respond" data-replyto="Reply to Jason" aria-label="Reply to Jason">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-2" id="li-comment-63">

				<div id="comment-63" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-63">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Thanks for the feedback, Jason. Glad it has been helpful to you!</p>
<p>That is interesting… I’ve tested/verified this by a) Using a Win7 system to RDP to both Win7 and Win10 systems, and b) investigating Win7 and Win10 systems for RDP behavior. Though, Windows is ever-changing, so I wonder if something may be different in a Win10 -&gt; Win10 setup or if something else is going on here. I can’t personally test at the moment, but obviously can’t argue your experience here. Though it doesn’t change the “1149 does not itself indicate a successful authentication”, it does change the perspective that these entries may not even be present on some Win10 onward systems (as would otherwise be useful to denote even unsuccessful attempts) unless a successful authentication has occurred (assuming something else isn’t going awry here).</p>
<p>I will reach out to Twitter #DFIR to see if anyone else can test/confirm/corroborate for the time being…</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-63">July 17, 2018</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=63#respond" data-commentid="63" data-postid="275" data-belowelement="comment-63" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment even thread-odd thread-alt depth-1" id="li-comment-71">

				<div id="comment-71" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/eaa6d2f1fc991a391af791aec15e7026.png" srcset="https://secure.gravatar.com/avatar/eaa6d2f1fc991a391af791aec15e7026?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Cody</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>For what it’s worth, and just an interesting note.  You have Event ID 21 with an IP address of “LOCAL”.  Based on testing this is merely a logon and not an RDP session.  It appears that a logon will add an Event 21/22 with address of “LOCAL” to the \System32\Winevt\Logs\Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational.evtx.  </p>
<p>In my testing I found that Event 21/22 with an actual IP address listed is a clear sign of RDP session, but don’t state that simply an event id 21/22 with IP of “LOCAL” indicated an RDP session.</p>
<p>Not sure if you came to the same conclusion, but do some testing and let me know what you think.</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-71">August 19, 2018</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=71#respond" data-commentid="71" data-postid="275" data-belowelement="comment-71" data-respondelement="respond" data-replyto="Reply to Cody" aria-label="Reply to Cody">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-2" id="li-comment-72">

				<div id="comment-72" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-72">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi Cody,</p>
<p>Thanks for the comment. That is a great point. You’re totally correct in that anything with a SourceNetworkAddress of “LOCAL” would indicate a local logon and not one from a remote machine (hence, the “LOCAL”). This actually applies not just to EID 21, but also 22, 24, and 25.</p>
<p>Great catch on my mistake in my event log capture for that example. I obviously captured the wrong one(s) and will update the screenshots here shortly to provide the proper example(s).</p>
<p>This is also a good time to remind everyone that this series is intended to denote a combination of logs that, when culled together and analyzed as a whole, can help indicate and track RDP logon history for a target. It was purposefully put together this way as Windows can be extremely ambiguous, unreliable, and downright initially confusing in what it logs (or does not). </p>
<p>This is actually a great example of where simply looking at an individual log can be very deceiving and confusing if you aren’t looking at everything that also occurred (or did not) before and after, or simply are not yet well versed in RDP event log investigations. If we found an Event 21 in the logs without other surrounding supporting logs, we would want to take a step back and ask why they weren’t found. In this case, there would be no surrounding supporting RDP events because a 21 with a “LOCAL” source is not in fact an RDP logon as you’ve very aptly pointed out. </p>
<p>Thanks for reading the blog/post and thanks again for your feedback. This was a great two-for (an opportunity to fix an error I’ve made as well as provide some additional context/tips for encountering EID’s with a “LOCAL” source). I’ve edited all the sections where this is applicable (namely for EID’s 21, 22, 24, and 25). </p>
<p>Please let me know if you find any other additions or mistakes. Windows seems to be updating some of its core functionality and logging more and more frequently. So it is inevitable this will need to be updated many more times to come. </p>
<p>JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-72">August 19, 2018</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=72#respond" data-commentid="72" data-postid="275" data-belowelement="comment-72" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment even thread-even depth-1" id="li-comment-77">

				<div id="comment-77" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/fada7f960b1175ee0c12372c4f2dfcbd.png" srcset="https://secure.gravatar.com/avatar/fada7f960b1175ee0c12372c4f2dfcbd?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Ray</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Thanks for your great post! Can You tell me where i can learn about the session ID’s? What does a session like 2 tell me?</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-77">October 17, 2018</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=77#respond" data-commentid="77" data-postid="275" data-belowelement="comment-77" data-respondelement="respond" data-replyto="Reply to Ray" aria-label="Reply to Ray">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-2" id="li-comment-80">

				<div id="comment-80" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-80">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi Ray,</p>
<p>I presume you are referring to and not the “Logon ID” or “Linked Logon ID” you might encounter in various event logs. </p>
<p><a href="https://docs.microsoft.com/en-us/windows/desktop/termserv/terminal-services-sessions" rel="nofollow">Here</a> is a quick rundown on RDP Sessions. </p>
<p>You can query the existing sessions (including RDP and local) on a machine by using the “quser”, “query session”, and/or “qwinsta” commands on an endpoint. </p>
<p>And, just for fun reading, you can see how you can shadow an RDP session on an endpoint. </p>
<p><a href="http://woshub.com/rds-shadow-how-to-connect-to-a-user-session-in-windows-server-2012-r2/" rel="nofollow ugc">http://woshub.com/rds-shadow-how-to-connect-to-a-user-session-in-windows-server-2012-r2/</a></p>
<p>Let me know if that doesn’t answer the question.</p>
<p>JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-80">November 18, 2018</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=80#respond" data-commentid="80" data-postid="275" data-belowelement="comment-80" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment even thread-odd thread-alt depth-1" id="li-comment-84">

				<div id="comment-84" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/506332f5e55e2cc03445ca5ce1b5fdb5.png" srcset="https://secure.gravatar.com/avatar/506332f5e55e2cc03445ca5ce1b5fdb5?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Sean</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi Jonathon,<br>
Great blog!! Very informative.<br>
I’m trying to understand why a LOCAL logon (within Event ID 21) would be recorded within the Remote Desktop Services logs?<br>
Does this indicate logging onto the physical machine or logging on remotely via a device on the same network?</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-84">December 8, 2018</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=84#respond" data-commentid="84" data-postid="275" data-belowelement="comment-84" data-respondelement="respond" data-replyto="Reply to Sean" aria-label="Reply to Sean">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-2" id="li-comment-86">

				<div id="comment-86" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-86">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi Sean,</p>
<p>Thanks for the compliment! And, thanks for the question.</p>
<p>As I note in my post, an EID 21 with “LOCAL” as the “Source Network Address” indicates a local logon (person locally sitting at keyboard logging on) and NOT an RDP logon. A true RDP logon will have an EID 21 with a remote machine’s IP in the “Source Network Address” field and will be proceeded by an EID 22 with the same remote IP. It’s a bit confusing, I know. </p>
<p>I wish I could tell you why, for whatever reason(s), Microsoft logs a LOCAL logon within the RDP LocalSessionManager log but I have no idea. This is just another one of those things where (at least for the meantime) you just make a note that it occurs so you don’t get hung up on it for future investigations. Perhaps someday someone can find out why through some more targeted testing and perhaps direct interrogation with MS, but for now it’s just one of those things (at least for me). </p>
<p>Hopefully that clears it up a bit. If not, try re-reading the paragraphs a few more times until it hopefully sinks in. I had to do that many times myself until I was finally able to grok it all. </p>
<p>Thanks again for reading and for the question!</p>
<p>JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-86">December 10, 2018</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=86#respond" data-commentid="86" data-postid="275" data-belowelement="comment-86" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment even depth-3" id="li-comment-92">

				<div id="comment-92" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/6203d741c91518d8e4da486329f867ce.png" srcset="https://secure.gravatar.com/avatar/6203d741c91518d8e4da486329f867ce?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>John Hanson</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi Jonathan!  This blog is of great value to the community!</p>
<p>I have a question that isn’t exactly related to the previous entry: what is event ID 59?  I have a log that contains several lines where there is an event 23 indicating a logoff, then followed by an event 24 indicating a disconnect, followed by event 39, and also a 59.</p>
<p>Unless I misunderstand events 23 and 24, this looks like something unusual occurred. Most of the time, I don’t see 24 occurring with an associated 23, and wondered what this means.</p>
<p>Thanks,</p>
<p>John</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-92">February 5, 2019</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=92#respond" data-commentid="92" data-postid="275" data-belowelement="comment-92" data-respondelement="respond" data-replyto="Reply to John Hanson" aria-label="Reply to John Hanson">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-4" id="li-comment-94">

				<div id="comment-94" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-94">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi John,</p>
<p>Thanks for the kind words, as well as the questions here. </p>
<p>With regard to seeing Event ID 23, 24, and 39 together/in sequence, you are experiencing very normal activity. To understand when/how/why these might occur together (and in certain orders) you need to understand that events are often very atomic – one specific thing occurred and I am reporting on it (without respect or context to other things). The logging system doesn’t care what happened before or after a given event, just that a specific event occurred that it needs to log and it does so. </p>
<p>So, when you think about things in a very silo’ed and atomic approach like this, you can start understanding that a formal logoff from an endpoint might very well include several sequential atomic operations of EID 23 (user initiates formal logoff), followed by EID 24 (the formal logoff initiates an RDP disconnection), followed by EID 39 (the RDP session has been disconnected/killed). In this vein, a disconnect would also include a EID 24 followed by a EID 39 and/or an EID 40 (but no EID 23 as there wasn’t a formal logoff, just a disconnect via “X”ing our or similar). </p>
<p>It is up to us as the humans to (attempt to) build the context and piece together the puzzle by putting all of these disparate atomic entries into a cohesive story of what (might have) happened. As you can see, the pairings and sequences depend on the action performed. So, both the presence and lack of presence of certain EID’s can help us determine the action(s). </p>
<p>Though, the major caveat in all of this is that while we know what often “should” occur, sometimes Windows just flubs it up and does/doesn’t produce something we expect. So, at times it takes a bit of educated guessing (sorry, it just is) if we have overwhelming reason to believe something did/didn’t happen but we are missing one or two pieces of information that don’t fit into the puzzle. Sometimes there are valid explanations that we don’t yet realize, and sometimes unfortunately there just isn’t an explanation and we’ve got to do our best to properly document the surrounding context that underpins our assessment. </p>
<p>This often nebulous and confusing situation of trying to put together a story from a wide array of EID’s was the genesis of me putting together this walkthrough to help people better piece these things together for RDP connections. </p>
<p>To also assist, Richard Davis (<a href="https://twitter.com/davisrichardg" rel="nofollow ugc">https://twitter.com/davisrichardg</a>) put together a rather useful flowchart for RDP that helps provide a nice visual for the (expected) flow of RDP event logs based on certain actions:</p>
<p><a href="https://www.13cubed.com/downloads/rdp_flowchart.pdf" rel="nofollow ugc">https://www.13cubed.com/downloads/rdp_flowchart.pdf</a></p>
<p>All that said, I’m not too familiar with Event ID 59’s. I’ve looked them up and see there is a subsection of the message called “ProcessingErrorData” with an associated “ErrorCode”, as well as ProcessID and ThreadID entries leading me to believe this may be more of a process error than anything directly relevant to tracking RDP connections. However, this is just my (marginally) educated guess as I’ve not had much direct experience with these. </p>
<p>At any rate, hopefully that provides a better understanding of why you’re seeing what you’re seeing. If not, please let me know and I’ll do my best to address in a different approach.</p>
<p>Thanks again for the feedback and questions. </p>
<p>-JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-94">February 6, 2019</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=94#respond" data-commentid="94" data-postid="275" data-belowelement="comment-94" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment even thread-even depth-1" id="li-comment-139">

				<div id="comment-139" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/2cab99449a64c02f825298d55d3791e2.png" srcset="https://secure.gravatar.com/avatar/2cab99449a64c02f825298d55d3791e2?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Javier Bruno</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hello! thanks for this post. Was very useful but I couldnt finish what I came here to do. I wanted to log logon failures on RDP. so If I have like 3, block a connection (thru a tool called Eventsentry based on eventlog) BUT, as you marked here, even log for that should be 4625, on logon type 10. But in my windows (2012, 2016, part of an AD and stand alone, both) just logs the logon failure as type 3. which is the same type of any other logon failure. Your screenshot and text export shows the same (no type 10 logon). Do you thing a way how I can specifically track logon failures for RDP?  THANKS</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-139">June 12, 2019</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=139#respond" data-commentid="139" data-postid="275" data-belowelement="comment-139" data-respondelement="respond" data-replyto="Reply to Javier Bruno" aria-label="Reply to Javier Bruno">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-2" id="li-comment-140">

				<div id="comment-140" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-140">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi Javier,</p>
<p>Thanks for reading my post and the great question. I love when questions/challenges help me update my post (and this is another great example). </p>
<p>You are correct – with the advent of NLA (Network Level Authentication) you will actually see Type 3 Logons for both 4624 and 4625 events (versus the Type 10 you might expect). I believe this started in Windows 10 (someone correct me if I’m wrong), and the reason for this is that Windows will first attempt to use NLA for authentication (even if you don’t have it configured) thus resulting in a Type 3 Logon for either a 4624 or 4625. </p>
<p>In the case of a failed logon, you will likely only see a 4625 Type 3 failure and not a Type 10 (but do not quote me on this, as we know things can be somewhat random with Event log stuff in Windows).</p>
<p>In the case of a successful logon, you will likely see a 4624 Type 3 followed by a 4624 Type 10. Again, I say “likely” see that as it has been sporadic in my testing (and others’ testing as well). </p>
<p>I have updated my post and attached screenshots to correct and (as best as possible) reflect this. I have also added NLA references, a reference to the Microsoft Forum answer to this, as well as references to David Cowen’s Forensic Lunch Test Kitchen 3-part series where he walks through real-time testing and realization of how wonky Windows event logging (especially with regard to RDP) is. </p>
<p>At any rate, thanks again for the question. Everyone can now benefit from better clarity surrounding 4624/4625 events because of it. </p>
<p>– JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-140">June 12, 2019</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=140#respond" data-commentid="140" data-postid="275" data-belowelement="comment-140" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment even depth-3" id="li-comment-143">

				<div id="comment-143" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/2cab99449a64c02f825298d55d3791e2.png" srcset="https://secure.gravatar.com/avatar/2cab99449a64c02f825298d55d3791e2?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Javier Bruno</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Wow, thanks for the quick reply. I was doing a lot of testing to find this and somehow somewhere I edited group policy of the computer (Im guessing) and in one of the SO testing I got an event ID 140 in /app serv logs/Microsoft/windows/RemoteDesktopServices-RdpCoreTS/Operational, where it says the bad login and ip address too! but at this point I do not know for sure that I changed, since I test the same on fresh SO and that ID error wont be logged.  I will keep trying <img draggable="false" role="img" class="emoji" alt="🙂" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/1f642.svg"> thanks for your reply again</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-143">June 15, 2019</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=143#respond" data-commentid="143" data-postid="275" data-belowelement="comment-143" data-respondelement="respond" data-replyto="Reply to Javier Bruno" aria-label="Reply to Javier Bruno">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-4" id="li-comment-144">

				<div id="comment-144" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-144">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi Javier,</p>
<p>Yes, you’ve hit on another area that I’ve had earmarked in my notes to update as well. </p>
<p>The Microsoft-Windows-RemoteDesktopServices-RdpCoreTS/Operational.evtx log provides some additional logs (namely 102, 103, 131, and 140) that help identify RDP connections (at times with source information lacking in other logs), and especially help when attempting to determine whether a 4624/4625 Type 3 was in fact an RDP (attempted) logon or simply a network logon. </p>
<p>Stay tuned for updates at some point in the hopefully not too distant future. </p>
<p>Thanks again for the question, insight, and responses. </p>
<p>JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-144">June 16, 2019</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=144#respond" data-commentid="144" data-postid="275" data-belowelement="comment-144" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment even thread-odd thread-alt depth-1" id="li-comment-141">

				<div id="comment-141" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/2a1f384cf3cf752cc5ff3b7502ec7e1b.png" srcset="https://secure.gravatar.com/avatar/2a1f384cf3cf752cc5ff3b7502ec7e1b?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>X</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Had to thank you for this write-up. After finding out about CVE-2019-0708, I wanted to make sure I was the only one accessing my desktop! Now I can sleep at night. Shared your post.</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-141">June 13, 2019</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=141#respond" data-commentid="141" data-postid="275" data-belowelement="comment-141" data-respondelement="respond" data-replyto="Reply to X" aria-label="Reply to X">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-2" id="li-comment-142">

				<div id="comment-142" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-142">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Thanks for the kind words and feedback. Glad it could help!</p>
<p>– JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-142">June 13, 2019</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=142#respond" data-commentid="142" data-postid="275" data-belowelement="comment-142" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment even thread-even depth-1" id="li-comment-149">

				<div id="comment-149" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/0ea87a2cf15d237326e47bf5d4a60a49.png" srcset="https://secure.gravatar.com/avatar/0ea87a2cf15d237326e47bf5d4a60a49?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Neil Torpey</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Very helpful resource, thanks for putting this together!</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-149">August 16, 2019</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=149#respond" data-commentid="149" data-postid="275" data-belowelement="comment-149" data-respondelement="respond" data-replyto="Reply to Neil Torpey" aria-label="Reply to Neil Torpey">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->

			<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-152">

				<div id="comment-152" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/be403c1152ecab447f0db1d8ce670f52.png" srcset="https://secure.gravatar.com/avatar/be403c1152ecab447f0db1d8ce670f52?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="http://none/" rel="external nofollow ugc" class="url">Joseph William Redfield</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hello, </p>
<p>I just wanted to put out there that I identified something that i’ve only found one other person in my google search to actually bring up.  My Event Log Reads like this:</p>
<p>–<br>
  RDSAppXPlugin</p>
<p>WHat is RDSAppXPlugin? I’m guessing Some security type app for Law enforcement purposes? Thought I’d see how common this is.</p>
<p>Thanks</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-152">September 30, 2019</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=152#respond" data-commentid="152" data-postid="275" data-belowelement="comment-152" data-respondelement="respond" data-replyto="Reply to Joseph William Redfield" aria-label="Reply to Joseph William Redfield">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor even depth-2" id="li-comment-155">

				<div id="comment-155" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-155">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi Joseph,</p>
<p>That is an interesting Event ID I do not recall noticing and had not researched. And, you’re right, there’s very little out there documenting its significance (if any).</p>
<p>So, I did a little bit of testing on my end. Turns out, this appears to simply be related to the RDP startup process(es) that occurs upon system start/reboot. You will see it intermingled with many of the startup events that occur on a system. As such, from my research/testing, it does not indicate anything more than that.</p>
<p>Given it’s only related to RDP initialization, I’m not sure it’s worth documenting as related to RDP logon/logoff investigations. </p>
<p>However…</p>
<p>In my testing, I did observe that Microsoft-Windows-TerminalServices-LocalSessionManager/Operational Event ID 23 will occur upon a system shutdown, and Event ID’s 21 and 22 will occur upon system boot/initialization with “Source Network Address: LOCAL” (even before any user-initiated login), which I think is worth nothing in the article in terms of notes/caveats for each. So, I will update this shortly with those additional data points.</p>
<p>Thanks for the question, and I hope this helped to answer it!</p>
<p>JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-155">October 1, 2019</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=155#respond" data-commentid="155" data-postid="275" data-belowelement="comment-155" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment odd alt thread-even depth-1" id="li-comment-156">

				<div id="comment-156" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/6d433366b3435d3c5f452ccc3daf4412.png" srcset="https://secure.gravatar.com/avatar/6d433366b3435d3c5f452ccc3daf4412?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Roman</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>First at all great article, it helped me already with some analysis.</p>
<p>But i would have a short question about an reason code i receive in the TerminalServices-LocalSessionManager Log, maybe you can help me with it:</p>
<p>“Session 90 has been disconnected, reason code 3489660929”</p>
<p>What is the reason code: 3489660929?</p>
<p>Currently my users are experiencing random disconnects on my RDS 2019 Farm where always this reason code pops up.</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-156">November 6, 2019</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=156#respond" data-commentid="156" data-postid="275" data-belowelement="comment-156" data-respondelement="respond" data-replyto="Reply to Roman" aria-label="Reply to Roman">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor even depth-2" id="li-comment-161">

				<div id="comment-161" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-161">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi Roman,</p>
<p>Thanks for the feedback!</p>
<p>Unfortunately, disconnect codes are hard to come by. In my cursory search, I found a post <a href="http://terminal312.rssing.com/chan-6668882/all_p1041.html" rel="nofollow ugc">here</a> that infers it may be related to users getting bumped from a server. However, it’s really hard to say. </p>
<p>All I can offer at this point is a couple links to disconnect codes I’ve come across and keep for my reference, though I don’t see your specific code in the below links.</p>
<p><a href="https://social.technet.microsoft.com/wiki/contents/articles/37874.rds-session-host-server-disconnect-codes.aspx" rel="nofollow ugc">https://social.technet.microsoft.com/wiki/contents/articles/37874.rds-session-host-server-disconnect-codes.aspx</a><br>
<a href="https://social.technet.microsoft.com/wiki/contents/articles/37870.remote-desktop-client-troubleshooting-disconnect-codes-and-reasons.aspx" rel="nofollow ugc">https://social.technet.microsoft.com/wiki/contents/articles/37870.remote-desktop-client-troubleshooting-disconnect-codes-and-reasons.aspx</a></p>
<p>Hope that at least helps a bit or gets you on the right path.</p>
<p>JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-161">November 16, 2019</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=161#respond" data-commentid="161" data-postid="275" data-belowelement="comment-161" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->

			<li class="comment odd alt depth-2" id="li-comment-172">

				<div id="comment-172" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/90df9b2951ad13d560923bf380b18e08.png" srcset="https://secure.gravatar.com/avatar/90df9b2951ad13d560923bf380b18e08?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Mark</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi Roman, hopefully this reaches you. Did you find a solution to this? Running into the same reason code, similar circumstances.</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-172">April 8, 2020</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=172#respond" data-commentid="172" data-postid="275" data-belowelement="comment-172" data-respondelement="respond" data-replyto="Reply to Mark" aria-label="Reply to Mark">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment even thread-odd thread-alt depth-1" id="li-comment-157">

				<div id="comment-157" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/71bdbc4544a80e2e1467253b06debf1b.jpeg" srcset="https://secure.gravatar.com/avatar/71bdbc4544a80e2e1467253b06debf1b?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>o2</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Thanks for your post.<br>
What if I see a 4779 event ID with client address:::1, how do we get the IP address?<br>
We only have the client name but no IP address. What do you advice?</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-157">November 6, 2019</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=157#respond" data-commentid="157" data-postid="275" data-belowelement="comment-157" data-respondelement="respond" data-replyto="Reply to o2" aria-label="Reply to o2">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-2" id="li-comment-160">

				<div id="comment-160" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-160">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Thanks for the thanks!</p>
<p>If you see a 4779 with a local address, it may just be part of a local logoff. As I explain in parts of my post, there are RDP-related events even for local logons/logoffs, which you will need to discern by source address being local type and/or surrounding context from other event ID’s. </p>
<p>Hard to say without surrounding Event ID’s for context, but that is what I would use to deduce what is occurring.</p>
<p>Hope that helps!</p>
<p>JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-160">November 16, 2019</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=160#respond" data-commentid="160" data-postid="275" data-belowelement="comment-160" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment even thread-even depth-1" id="li-comment-175">

				<div id="comment-175" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/202b9c7603ff503919c027403edf50de.png" srcset="https://secure.gravatar.com/avatar/202b9c7603ff503919c027403edf50de?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://www.trimmnetworks.com/" rel="external nofollow ugc" class="url">Sean Trimm</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>I hope someone else has experienced what I am with several Windows 2012R2 RDS Hosts and the LocalSessionManager / Operational log:  No matter how the log properties are changed via GPO (registry edits as there are no templates for these logs) or in the GUI the log will not grow over 1MB.  This is a major PITA as we are using this as part of our COVID-19 response plan read and processed by a powershell application I wrote.  I am at the point of pulling off the logs daily to keep a record but with 10 hosts serving RDS it would be preferable to read the logs when necessary without the upfront processing efforts for logs that may never be used.  </p>
<p>Does anyone know why this is and how to work around it? </p>
<p>Thank you in advance.</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-175">May 4, 2020</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=175#respond" data-commentid="175" data-postid="275" data-belowelement="comment-175" data-respondelement="respond" data-replyto="Reply to Sean Trimm" aria-label="Reply to Sean Trimm">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-2" id="li-comment-176">

				<div id="comment-176" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-176">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi Sean,</p>
<p>I can’t directly speak to the maximum log file size configuration not sticking/working. Hopefully others can.</p>
<p>However, I did want to suggest considering implementing Windows Event Forwarding (WEF) from your RDS (and any other important) servers to a centralize log repository/SIEM. It’s actually a good idea (i.e. best practice) to ship logs off the endpoints to a centralized and secured repository to avoid data loss issues (due to both explicit attacker deletion or configuration issues like this) as well as provide more effective environment-wide data searching during investigations. </p>
<p><a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/use-windows-event-forwarding-to-assist-in-intrusion-detection" rel="nofollow ugc">Here</a><a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/use-windows-event-forwarding-to-assist-in-intrusion-detection" rel="nofollow ugc">Here</a> is a great Microsoft resource for understanding and implementing WEF. However, there are tons of resources available with walkthroughs, like <a href="https://hackernoon.com/the-windows-event-forwarding-survival-guide-2010db7a68c4" rel="nofollow ugc">here</a><a href="https://hackernoon.com/the-windows-event-forwarding-survival-guide-2010db7a68c4" rel="nofollow ugc">here</a> and <a href="https://www.petri.com/configure-event-log-forwarding-windows-server-2012-r2" rel="nofollow ugc">here</a><a href="https://www.petri.com/configure-event-log-forwarding-windows-server-2012-r2" rel="nofollow ugc">here</a>.</p>
<p>Anyway, hope that helps!</p>
<p>JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-176">May 5, 2020</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=176#respond" data-commentid="176" data-postid="275" data-belowelement="comment-176" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment even thread-odd thread-alt depth-1" id="li-comment-178">

				<div id="comment-178" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/592029b0e21cce32499210e44fec4d18.png" srcset="https://secure.gravatar.com/avatar/592029b0e21cce32499210e44fec4d18?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Sema</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>HI<br>
Thank you for your great information in this post. I have a question and I hope you can reply it. I am working on RDP events, in addition to these events mentioned here there are a wide range of events occurring during testing this software by various predetermined scenarios such as event IDs 142,143,226 and so on. How can I get a complete document about event IDs have been occurring?</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-178">June 24, 2020</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=178#respond" data-commentid="178" data-postid="275" data-belowelement="comment-178" data-respondelement="respond" data-replyto="Reply to Sema" aria-label="Reply to Sema">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-2" id="li-comment-183">

				<div id="comment-183" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-183">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi Sema,</p>
<p>Thanks for reading my blog, the kind words, and the follow-up question.</p>
<p>As you can see, there isn’t a single source to go to (that I’m aware of) that comprehensively covers all applicable RDP-related events and ID’s, particularly for both the target and host. </p>
<p>In this blog post, I attempted to cover most of the target system event ID’s of importance as those are most often what are being analyzed for possible compromise. That said, I’ve collected additional events and ID’s since initial authoring of this post that should also be included – some of which you’ve noted in your comment and I’ve also noted in my response to a similar comment/question <a href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-143">here</a>.</p>
<p>The plan is to update this post in the future, as well as author another separate post that will cover a lot of the client side events and ID’s as well.</p>
<p>As you can see, there is just so much to cover and so little time <img draggable="false" role="img" class="emoji" alt="🙂" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/1f642.svg"></p>
<p>At any rate, I hope what I have at least helped more than having to spend a ton of time doing Google searches and attempting to piece a bunch of disparate things together.</p>
<p>JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-183">August 11, 2020</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=183#respond" data-commentid="183" data-postid="275" data-belowelement="comment-183" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment even thread-even depth-1" id="li-comment-179">

				<div id="comment-179" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/72ac1a3b5b33b7eb743941c4117d37cb.png" srcset="https://secure.gravatar.com/avatar/72ac1a3b5b33b7eb743941c4117d37cb?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>akira yan</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Thanks for the detailed description of these event IDs.<br>
I found one is missed.<br>
If the account does not have permission to logon via RDP, i.e. not in the group “Remote Desktop Users” or not in the Administrators group, the remote server will deny the connection, and in the security.evtx of source host, there is an eventID=4825 (RDP denied).</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-179">June 27, 2020</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=179#respond" data-commentid="179" data-postid="275" data-belowelement="comment-179" data-respondelement="respond" data-replyto="Reply to akira yan" aria-label="Reply to akira yan">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-2" id="li-comment-182">

				<div id="comment-182" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-182">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi Akira,</p>
<p>Thanks for the kind words and feedback.</p>
<p>Correct, logon failures (including RDP incorrect password and explicitly denied users) are capture in Security Event ID 4825 on the target (even when the username doesn’t exist. However, I’m not aware if that error is also logged on the source host as well. Have you tested and verified this? If so, that would be good to note for future “client side” series on RDP.</p>
<p>JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-182">August 11, 2020</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=182#respond" data-commentid="182" data-postid="275" data-belowelement="comment-182" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment even thread-odd thread-alt depth-1" id="li-comment-184">

				<div id="comment-184" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/ef39a3eb1d7b1f535d6cec726b6d0602.png" srcset="https://secure.gravatar.com/avatar/ef39a3eb1d7b1f535d6cec726b6d0602?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Alex</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hello Jonathon</p>
<p>Pardon me if missed, but how about event ids for events initated by server (e.g. due to group policies linked to terminating long time disconnected sessions)?</p>
<p>Regards</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-184">August 24, 2020</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=184#respond" data-commentid="184" data-postid="275" data-belowelement="comment-184" data-respondelement="respond" data-replyto="Reply to Alex" aria-label="Reply to Alex">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor odd alt depth-2" id="li-comment-198">

				<div id="comment-198" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-198">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi, Alex. Good question. See my response to a similar question from Jeff!</p>
<p>JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-198">March 19, 2021</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=198#respond" data-commentid="198" data-postid="275" data-belowelement="comment-198" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment even thread-even depth-1" id="li-comment-185">

				<div id="comment-185" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/b18b457270d15809acffbfd9efc2d98f.png" srcset="https://secure.gravatar.com/avatar/b18b457270d15809acffbfd9efc2d98f?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Metalline</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Great article, thanks! There is also a good article related to rdp logs here – <a href="https://sysadminpoint.com/2020/07/13/how_to_view_rdp_connection_logs_in_windows/" rel="nofollow ugc">https://sysadminpoint.com/2020/07/13/how_to_view_rdp_connection_logs_in_windows/</a></p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-185">August 28, 2020</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=185#respond" data-commentid="185" data-postid="275" data-belowelement="comment-185" data-respondelement="respond" data-replyto="Reply to Metalline" aria-label="Reply to Metalline">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->

			<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-186">

				<div id="comment-186" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/42a4c3b95547e473fed4e479b6b30af4.png" srcset="https://secure.gravatar.com/avatar/42a4c3b95547e473fed4e479b6b30af4?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Julie</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hello,<br>
How can I determine who is killing rdp connections for other users?</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-186">September 14, 2020</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=186#respond" data-commentid="186" data-postid="275" data-belowelement="comment-186" data-respondelement="respond" data-replyto="Reply to Julie" aria-label="Reply to Julie">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor even depth-2" id="li-comment-197">

				<div id="comment-197" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-197">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi Julie,</p>
<p>I would suggest doing some timeline analysis of the RDP events as they occur chronologically. I’d imagine you would be able to piece this together by following the trail of disconnects and the subsequent connection.</p>
<p>Hope that helps.</p>
<p>JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-197">March 19, 2021</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=197#respond" data-commentid="197" data-postid="275" data-belowelement="comment-197" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment odd alt thread-even depth-1" id="li-comment-189">

				<div id="comment-189" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/9b90e7fb0309efaeaef48eccf102a922.png" srcset="https://secure.gravatar.com/avatar/9b90e7fb0309efaeaef48eccf102a922?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Jeff</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Jonathan,</p>
<p>For a beginner this is such a great compilation of information regarding the sequence of RDP events.  Thank you so much for putting this together as I’ve found it very educational / informative.  That said I have one question which you may be able to quickly answer.  Within GPOs there are two settings: “set time limit for disconnect session” and “set time limit for active but idle RDP session”… which allow a forced disconnect of an idle RDP session to the target server the GPO is applied to.  In the event that an RDP session is killed due to either of these settings, what would the logs look like that would allow me to uniquely identify this from other disconnects?  I assume I would see event ID 24 for a disconnect, paired with event ID 40 and a reason code of 3 (for idle time out) or 4 (for time limit). </p>
<p>Thanks for your time and response,<br>
Jeff</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-189">December 28, 2020</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=189#respond" data-commentid="189" data-postid="275" data-belowelement="comment-189" data-respondelement="respond" data-replyto="Reply to Jeff" aria-label="Reply to Jeff">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor even depth-2" id="li-comment-196">

				<div id="comment-196" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-196">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi, Jeff. Good question!</p>
<p>I’d actually have to test to see myself. Perhaps you could do the same and report back? That would be good to know, for sure.</p>
<p>JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-196">March 19, 2021</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=196#respond" data-commentid="196" data-postid="275" data-belowelement="comment-196" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-190">

				<div id="comment-190" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/9a5b9758ea152719cb93a1edeab3c043.png" srcset="https://secure.gravatar.com/avatar/9a5b9758ea152719cb93a1edeab3c043?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Fabio</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Perfect Information. Thank you very much for making this content available.<br>
I am doing an analysis in my environment and I receive several connections and disconnections with the sequences of reasons 0 and 5 in eventvwr (Microsoft-Windows-TerminalServices-LocalSessionManager) EventID 40.</p>
<p>Do you have any idea why my users have multiple disconnections and simultaneous connections?</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-190">January 4, 2021</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=190#respond" data-commentid="190" data-postid="275" data-belowelement="comment-190" data-respondelement="respond" data-replyto="Reply to Fabio" aria-label="Reply to Fabio">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor even depth-2" id="li-comment-195">

				<div id="comment-195" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-195">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi, Fabio. Thanks for the question.</p>
<p>Here is a reference to the reason codes for that event. <a href="https://docs.microsoft.com/en-us/windows/win32/termserv/extendeddisconnectreasoncode" rel="nofollow ugc">https://docs.microsoft.com/en-us/windows/win32/termserv/extendeddisconnectreasoncode</a></p>
<p>Those codes correlate to:</p>
<p>0 – No additional information is available. (not very helpful)<br>
5 – The client’s connection was replaced by another connection.</p>
<p>So, it seems that you are reaching the maximum amount of simultaneous user connections allowed at once, and thus it is replacing certain existing connections with the new one(s).</p>
<p>I would look into how to adjust the number of simultaneous connections for your endpoint as a possible solution. </p>
<p>Hope that helps!</p>
<p>JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-195">March 19, 2021</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=195#respond" data-commentid="195" data-postid="275" data-belowelement="comment-195" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment odd alt thread-even depth-1" id="li-comment-193">

				<div id="comment-193" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/155354f151b7a248c7954c61b37ae2b5.png" srcset="https://secure.gravatar.com/avatar/155354f151b7a248c7954c61b37ae2b5?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Martin</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Great article. Very helpful.<br>
The information provided a very up-to-date help in the avalanche of a ransomware extortion crime. Thank you for the valuable information.</p>
<p>Greetings from Germany<br>
Martin</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-193">March 19, 2021</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=193#respond" data-commentid="193" data-postid="275" data-belowelement="comment-193" data-respondelement="respond" data-replyto="Reply to Martin" aria-label="Reply to Martin">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor even depth-2" id="li-comment-194">

				<div id="comment-194" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-194">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Thanks, Martin. I appreciate the feedback and glad it could help you out!</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-194">March 19, 2021</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=194#respond" data-commentid="194" data-postid="275" data-belowelement="comment-194" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

			<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-199">

				<div id="comment-199" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/0068681f9568e8321f220cacb9ec1074.png" srcset="https://secure.gravatar.com/avatar/0068681f9568e8321f220cacb9ec1074?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
					<div class="comment-inner">

						<div class="comment-header">
							<h4>Ankit</h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Would it be ‘normal’ to see 4624 type 3 events on a DC ? From my understanding, those are logon events and not account logon (authentication) events and should be logged on the actual resource / destination host.</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-199">April 12, 2021</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=199#respond" data-commentid="199" data-postid="275" data-belowelement="comment-199" data-respondelement="respond" data-replyto="Reply to Ankit" aria-label="Reply to Ankit">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			<ul class="children">

			<li class="comment byuser comment-author-jp bypostauthor even depth-2" id="li-comment-203">

				<div id="comment-203" class="comment">

					<img alt="" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/c3896f35721bbb012deac10134f8dab6.png" srcset="https://secure.gravatar.com/avatar/c3896f35721bbb012deac10134f8dab6?s=320&amp;d=mm&amp;r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">
						<a class="comment-author-icon" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-203">
							<div class="genericon genericon-user"></div>
						</a>

					
					<div class="comment-inner">

						<div class="comment-header">
							<h4><a href="https://ponderthebits.com/" rel="external nofollow ugc" class="url">Jonathon Poling</a></h4>
						</div><!-- .comment-header -->

						<div class="comment-content post-content">
							<p>Hi Ankit,</p>
<p>Yes, those are normal to see on the DC when leveraging AD/Kerberos from members logging onto the domain and their workstations.</p>
<p>JP</p>
						</div><!-- .comment-content -->

						<div class="comment-meta">

							<div>
								<div class="genericon genericon-day"></div><a class="comment-date-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#comment-203">May 9, 2021</a>
							</div>

							
							<div><div class="genericon genericon-reply"></div><a rel="nofollow" class="comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/?replytocom=203#respond" data-commentid="203" data-postid="275" data-belowelement="comment-203" data-respondelement="respond" data-replyto="Reply to Jonathon Poling" aria-label="Reply to Jonathon Poling">Reply</a></div>
						</div><!-- .comment-meta -->

					</div><!-- .comment-inner -->

				</div><!-- .comment-## -->

			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
				</ol>

				
					<div class="pingbacks">

						<h3 class="pingbacks-title">

							13 Pingbacks
						</h3>

						<ol class="pingbacklist">
							
			<li class="pingback even thread-even depth-1" id="comment-48">
				 <a href="http://cyberforensicator.com/2018/02/21/windows-rdp-related-event-logs-identification-tracking-and-investigation/" rel="external nofollow ugc" class="url">Windows RDP-Related Event Logs: Identification, Tracking, and Investigation – Cyber Forensicator</a> 			</li>

			<!-- #comment-## -->

			<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-59">
				 <a href="http://linuxkitchen.com/2018/05/24/remote-desktop-connection-rdc-failed/" rel="external nofollow ugc" class="url">Remote Desktop Connection (RDC) Failed | Linux, Windows, Heklanje, Kuhinja</a> 			</li>

			<!-- #comment-## -->

			<li class="pingback even thread-even depth-1" id="comment-67">
				 <a href="https://www.syspanda.com/index.php/2018/07/16/remote-connection-dashboards-vnc-rdp/" rel="external nofollow ugc" class="url">Remote Connection Dashboards: VNC &amp; RDP - Syspanda</a> 			</li>

			<!-- #comment-## -->

			<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-83">
				 <a href="http://en.linuxkitchen.com/2018/11/26/remote-desktop-connection-rdc-failed-rdc-win7-to-win7/" rel="external nofollow ugc" class="url">Remote Desktop Connection (RDC) Failed, RDC WIN7 to WIN7 | Linux, Windows, Crochet, Kitchen</a> 			</li>

			<!-- #comment-## -->

			<li class="pingback even thread-even depth-1" id="comment-89">
				 <a href="https://www.trustedsec.com/2019/01/adventures-of-an-rdp-honeypot-part-one-rdp-security/" rel="external nofollow ugc" class="url">Adventures of an RDP Honeypot – Part One: RDP Security - TrustedSec</a> 			</li>

			<!-- #comment-## -->

			<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-90">
				 <a href="https://f1tym1.com/2019/01/28/adventures-of-an-rdp-honeypot-part-one-rdp-security/" rel="external nofollow ugc" class="url">Adventures of an RDP Honeypot – Part One: RDP Security - f1tym1</a> 			</li>

			<!-- #comment-## -->

			<li class="pingback even thread-even depth-1" id="comment-98">
				 <a href="https://dfironthemountain.wordpress.com/2019/02/15/rdp-event-log-dfir/" rel="external nofollow ugc" class="url">RDP Event Log DFIR – DFIR on the Mountain</a> 			</li>

			<!-- #comment-## -->

			<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-111">
				 <a href="https://movaxbx.ru/2019/04/09/rdp-event-log-dfir/" rel="external nofollow ugc" class="url">MOV AX, BX Code depilation salon: Articles, Code samples, Processor code documentation, Low-level programming, Working with debuggers RDP Event Log DFIR</a> 			</li>

			<!-- #comment-## -->

			<li class="pingback even thread-even depth-1" id="comment-137">
				 <a href="https://www.tiforense.com.br/forense-em-logs-de-evento-rdp/" rel="external nofollow ugc" class="url">Forense em Logs de Evento RDP – TI Forense</a> 			</li>

			<!-- #comment-## -->

			<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-150">
				 <a href="https://www.pcsecurity-99.com/2019/08/21/how-to-avoid-using-rdp-on-windows/" rel="external nofollow ugc" class="url">How to avoid using RDP on Windows – pcsecurity-99.com</a> 			</li>

			<!-- #comment-## -->

			<li class="pingback even thread-even depth-1" id="comment-174">
				 <a href="https://tranquilsec.com/elementor-2444/" rel="external nofollow ugc" class="url">Elementor #2444 – TRANQUIL SECURITY</a> 			</li>

			<!-- #comment-## -->

			<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-181">
				 <a href="https://baysoft.wordpress.com/2020/07/12/track-remote-desktop-login-rdp-activities/" rel="external nofollow ugc" class="url">Track Remote Desktop Login RDP activities | Baysoft's Blog</a> 			</li>

			<!-- #comment-## -->

			<li class="pingback even thread-even depth-1" id="comment-204">
				 <a href="https://holdmybeersecurity.com/2021/06/02/part-3-intro-to-threat-hunting-hunting-the-imposter-among-us-with-the-elastic-stack-and-sysmon/" rel="external nofollow ugc" class="url">Part 3: Intro to threat hunting –&nbsp;Hunting the imposter among us with the Elastic stack and Sysmon | HoldMyBeer</a> 			</li>

			<!-- #comment-## -->
						</ol>

					</div><!-- .pingbacks -->

				
				
			</div><!-- .comments -->

		</div><!-- .comments-inner -->

	</div><!-- .comments-container -->

	<div class="respond-container">	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://ponderthebits.com/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required="required"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" required="required"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200"></p>
<p class="cptch_block"><span class="cptch_title">No Bots. No Spam.<span class="required"> *</span></span><script class="cptch_to_remove" type="text/javascript">
						(function( d, tag, id ) {
							var script = d.getElementById( id );
							if ( script )
								return;
							add_script( "", "", id );

							if ( typeof( cptch_vars ) == "undefined" ) {
								var local = {
									nonce:     "f2f72899ff",
									ajaxurl:   "https://ponderthebits.com/wp-admin/admin-ajax.php",
									enlarge:   ""
								};
								add_script( "", "/* <![CDATA[ */var cptch_vars=" + JSON.stringify( local ) + "/* ]]> */" );
							}

							d.addEventListener( "DOMContentLoaded", function() {
								var scripts         = d.getElementsByTagName( tag ),
									captcha_script  = /https:\/\/ponderthebits.com\/wp-content\/plugins\/captcha\/js\/front_end_script.js/,
									include_captcha = true;
								if ( scripts ) {
									for ( var i = 0; i < scripts.length; i++ ) {
										if ( scripts[ i ].src.match( captcha_script ) ) {
											include_captcha = false;
											break;
										}
									}
								}
								if ( typeof jQuery == "undefined" ) {
									var siteurl = "https://ponderthebits.com";
									add_script( siteurl + "/wp-includes/js/jquery/jquery.js" );
									add_script( siteurl + "/wp-includes/js/jquery/jquery-migrate.min.js" );
								}
								if ( include_captcha )
									add_script( "https://ponderthebits.com/wp-content/plugins/captcha/js/front_end_script.js" );
							});

							function add_script( url, content, js_id ) {
								url     = url     || "";
								content = content || "";
								js_id   = js_id   || "";
								var script = d.createElement( tag );
								if ( url )
									script.src = url;
								if ( content )
									script.appendChild( d.createTextNode( content ) );
								if ( js_id )
									script.id = js_id;
								script.setAttribute( "type", "text/javascript" );
								d.body.appendChild( script );
							}
						})( document, "script", "cptch_script_loader" );
					</script><span class="cptch_wrap cptch_recognition">
				<label class="cptch_label" for="cptch_input_48"><span class="cptch_images_wrap"><span class="cptch_span">1</span><span class="cptch_span">9</span><span class="cptch_span">six</span></span>
				<input id="cptch_input_48" class="cptch_input cptch_wp_comments" type="text" autocomplete="off" name="cptch_number" value="" maxlength="3" size="3" aria-required="true" required="required" style="margin-bottom: 0px; font-size: 12px; max-width: 100%; width: 52.0312px;">
				<input type="hidden" name="cptch_result" value="huW+EQ=="><input type="hidden" name="cptch_time" value="1633542225">
					<input type="hidden" name="cptch_form" value="wp_comments">
				</label><span class="cptch_reload_button_wrap hide-if-no-js">
					<noscript>
						<style type="text/css">
							.hide-if-no-js {
								display: none !important;
							}
						</style>
					</noscript>
					<span class="cptch_reload_button dashicons dashicons-update"></span>
				</span></span></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="275" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p></form>	</div><!-- #respond -->
	</div><!-- .respond-container -->
					</article><!-- .post -->

					
		</div><!-- .content -->

					<aside class="sidebar">

	<div id="sfsi-widget-2" class="widget sfsi"><div class="widget-content"><h3 class="widget-title">Subscribe (RSS) and Tweet!</h3>		<div class="sfsi_widget" data-position="widget" style="display:flex;flex-wrap:wrap;justify-content: left">
			<div id="sfsi_wDiv"></div>
			<div class="norm_row sfsi_wDiv " style="width:225px;position:absolute;;text-align:left"><div style="width:40px; height:40px;margin-left:5px;margin-bottom:5px; " class="sfsi_wicons shuffeldiv "><div class="inerCnt"><a class=" sficn" data-effect="" target="_blank" href="https://ponderthebits.com/feed/" id="sfsiid_rss" style="opacity:1"><img data-pin-nopin="true" alt="RSS" title="RSS" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/default_rss.png" width="40" height="40" style="" class="sfcm sfsi_wicon " data-effect=""></a></div></div><div style="width:40px; height:40px;margin-left:5px;margin-bottom:5px; " class="sfsi_wicons shuffeldiv "><div class="inerCnt"><a class=" sficn" data-effect="" target="_blank" href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/" id="sfsiid_twitter" style="opacity:1"><img data-pin-nopin="true" alt="Twitter" title="Twitter" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/default_twitter.png" width="40" height="40" style="" class="sfcm sfsi_wicon " data-effect=""></a><div class="sfsi_tool_tip_2 twt_tool_bdr sfsiTlleft" style="width: 59px; opacity: 0; z-index: -1; margin-left: -46px; display: none;" id="sfsiid_twitter"><span class="bot_arow bot_twt_arow"></span><div class="sfsi_inside"><div class="icon1"><a target="_blank" href="https://twitter.com/intent/user?screen_name=JPoForenso">
			<img data-pin-nopin="true" width="auto" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/en_US_Follow.svg" class="sfsi_wicon" alt="Follow Me" title="Follow Me" style="opacity: 1;">
			</a></div><div class="icon2"><div class="sf_twiter" style="display: inline-block;vertical-align: middle;width: auto;">
						<a target="_blank" href="https://twitter.com/intent/tweet?text=Hey%2C+this+guy+writes+some+great+stuff%21+https%3A%2F%2Fponderthebits.com+%23DFIR+via%40JPoForenso+https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation" style="display:inline-block">
							<img data-pin-nopin="true" width="auto" class="sfsi_wicon" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/en_US_Tweet.svg" alt="Tweet" title="Tweet">
						</a>
					</div></div></div></div></div></div></div><div id="sfsi_holder" class="sfsi_holders" style="position: relative; float: left; width: 100%; z-index: -1; height: 63px;"></div><script>window.addEventListener("sfsi_functions_loaded", function() 
			{
				if (typeof sfsi_widget_set == "function") {
					sfsi_widget_set();
				}
			}); </script>			<div style="clear: both;"></div>
		</div>
	</div></div><div id="search-2" class="widget widget_search"><div class="widget-content">
<form method="get" class="search-form" id="search-form-615de04cb849d" action="https://ponderthebits.com/">
	<input type="search" class="search-field" placeholder="Search form" name="s" id="s-615de04cb849e">
	<button type="submit" class="search-button"><div class="genericon genericon-search"></div><span class="screen-reader-text">Search</span></button>
</form>
</div></div><div id="widget_lovecraft_recent_posts-3" class="widget Widget_Lovecraft_Recent_Posts"><div class="widget-content">
				<ul class="lovecraft-widget-list">

					
						<li class="group">

							<a href="https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/">

								<div class="post-icon">

									
										<div class="genericon genericon-standard"></div>

									
								</div>

								<div class="inner">
									<p class="title">Windows RDP-Related Event Logs: Identification, Tracking, and Investigation</p>
									<p class="meta">February 20, 2018</p>
								</div>

							</a>

						</li>

						
						<li class="group">

							<a href="https://ponderthebits.com/2018/02/generating-file-system-listings-from-the-command-line-with-full-macb-timestamps-and-hashes/">

								<div class="post-icon">

									
										<div class="genericon genericon-standard"></div>

									
								</div>

								<div class="inner">
									<p class="title">Generating File System Listings from the Command Line (with Full MACB Timestamps and Hashes)</p>
									<p class="meta">February 1, 2018</p>
								</div>

							</a>

						</li>

						
						<li class="group">

							<a href="https://ponderthebits.com/2017/07/decompressing-and-extracting-artifacts-from-windows-8-server-2012-hibernation-files/">

								<div class="post-icon">

									
										<div class="genericon genericon-standard"></div>

									
								</div>

								<div class="inner">
									<p class="title">Decompressing and Extracting Artifacts from Windows 8 / Server 2012+ Hibernation Files</p>
									<p class="meta">July 5, 2017</p>
								</div>

							</a>

						</li>

						
						<li class="group">

							<a href="https://ponderthebits.com/2017/03/quicker-mounting-and-dismounting-of-lvms-on-forensic-images/">

								<div class="post-icon">

									
										<div class="genericon genericon-standard"></div>

									
								</div>

								<div class="inner">
									<p class="title">Quick(er) Mounting and Dismounting of LVM’s on Forensic Images</p>
									<p class="meta">March 29, 2017</p>
								</div>

							</a>

						</li>

						
						<li class="group">

							<a href="https://ponderthebits.com/2017/03/the-importance-of-incident-scopingassessment/">

								<div class="post-icon">

									
										<div class="genericon genericon-standard"></div>

									
								</div>

								<div class="inner">
									<p class="title">The Importance of Incident Scoping/Assessment</p>
									<p class="meta">March 14, 2017</p>
								</div>

							</a>

						</li>

						
				</ul>

			</div></div><div id="weblizar_twitter-2" class="widget widget_weblizar_twitter"><div class="widget-content"><h3 class="widget-title">Tweets from JPoForenso</h3><div style="display:block;width:100%;float:left;overflow:hidden">
	<iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" class="twitter-timeline twitter-timeline-rendered" style="position: static; visibility: visible; display: inline-block; width: 299.812px; height: 500px; padding: 0px; border: none; max-width: 100%; min-width: 180px; margin-top: 0px; margin-bottom: 0px; min-height: 200px;" data-widget-id="profile:jpoforenso" title="Twitter Timeline" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/saved_resource.html"></iframe>

</div>
</div></div><div id="archives-2" class="widget widget_archive"><div class="widget-content"><h3 class="widget-title">Archives</h3>
			<ul>
					<li><a href="https://ponderthebits.com/2018/02/">February 2018</a></li>
	<li><a href="https://ponderthebits.com/2017/07/">July 2017</a></li>
	<li><a href="https://ponderthebits.com/2017/03/">March 2017</a></li>
	<li><a href="https://ponderthebits.com/2017/02/">February 2017</a></li>
	<li><a href="https://ponderthebits.com/2017/01/">January 2017</a></li>
	<li><a href="https://ponderthebits.com/2016/12/">December 2016</a></li>
			</ul>

			</div></div><div id="categories-2" class="widget widget_categories"><div class="widget-content"><h3 class="widget-title">Topics</h3>
			<ul>
					<li class="cat-item cat-item-21"><a href="https://ponderthebits.com/category/assessment/">Assessment</a> (1)
</li>
	<li class="cat-item cat-item-12"><a href="https://ponderthebits.com/category/aws/">AWS</a> (1)
</li>
	<li class="cat-item cat-item-13"><a href="https://ponderthebits.com/category/azure/">Azure</a> (1)
</li>
	<li class="cat-item cat-item-14"><a href="https://ponderthebits.com/category/cloud/">Cloud</a> (1)
</li>
	<li class="cat-item cat-item-9"><a href="https://ponderthebits.com/category/command-line/">Command Line</a> (7)
</li>
	<li class="cat-item cat-item-5"><a href="https://ponderthebits.com/category/dfir-community/">DFIR Community</a> (1)
</li>
	<li class="cat-item cat-item-29"><a href="https://ponderthebits.com/category/event-logs/">Event Logs</a> (1)
</li>
	<li class="cat-item cat-item-23"><a href="https://ponderthebits.com/category/forensics/">Forensics</a> (3)
</li>
	<li class="cat-item cat-item-26"><a href="https://ponderthebits.com/category/hibernation-file/">Hibernation File</a> (1)
</li>
	<li class="cat-item cat-item-27"><a href="https://ponderthebits.com/category/hibernation-recon/">Hibernation Recon</a> (1)
</li>
	<li class="cat-item cat-item-22"><a href="https://ponderthebits.com/category/incident-response/">Incident Response</a> (4)
</li>
	<li class="cat-item cat-item-4"><a href="https://ponderthebits.com/category/inspirations/">Inspirations</a> (1)
</li>
	<li class="cat-item cat-item-6"><a href="https://ponderthebits.com/category/introduction/">Introduction</a> (1)
</li>
	<li class="cat-item cat-item-7"><a href="https://ponderthebits.com/category/know-your-tools/">Know Your Tools</a> (2)
</li>
	<li class="cat-item cat-item-10"><a href="https://ponderthebits.com/category/linux/">Linux</a> (3)
</li>
	<li class="cat-item cat-item-24"><a href="https://ponderthebits.com/category/lvm/">LVM</a> (1)
</li>
	<li class="cat-item cat-item-11"><a href="https://ponderthebits.com/category/mac/">Mac</a> (5)
</li>
	<li class="cat-item cat-item-15"><a href="https://ponderthebits.com/category/osx/">OSX</a> (5)
</li>
	<li class="cat-item cat-item-19"><a href="https://ponderthebits.com/category/osxpmem/">osxpmem</a> (1)
</li>
	<li class="cat-item cat-item-31"><a href="https://ponderthebits.com/category/rdp/">RDP</a> (1)
</li>
	<li class="cat-item cat-item-18"><a href="https://ponderthebits.com/category/rekall/">Rekall</a> (1)
</li>
	<li class="cat-item cat-item-30"><a href="https://ponderthebits.com/category/remote-desktop/">Remote Desktop</a> (1)
</li>
	<li class="cat-item cat-item-20"><a href="https://ponderthebits.com/category/scoping/">Scoping</a> (1)
</li>
	<li class="cat-item cat-item-8"><a href="https://ponderthebits.com/category/tools/">Tools</a> (5)
</li>
	<li class="cat-item cat-item-1"><a href="https://ponderthebits.com/category/uncategorized/">Uncategorized</a> (3)
</li>
	<li class="cat-item cat-item-25"><a href="https://ponderthebits.com/category/vmdk/">VMDK</a> (1)
</li>
	<li class="cat-item cat-item-16"><a href="https://ponderthebits.com/category/volatility/">Volatility</a> (2)
</li>
	<li class="cat-item cat-item-28"><a href="https://ponderthebits.com/category/windows/">Windows</a> (1)
</li>
	<li class="cat-item cat-item-17"><a href="https://ponderthebits.com/category/yara/">Yara</a> (1)
</li>
			</ul>

			</div></div>
</aside><!-- .sidebar -->
		
	</div><!-- .section-inner -->

</div><!-- .wrapper -->

		</main><!-- #site-content -->

		
		<div class="credits section bg-dark">

			<div class="credits-inner section-inner">

				<p class="powered-by">Powered by <a href="https://www.wordpress.org/">WordPress</a> <span class="sep">&amp;</span> <span class="theme-by">Theme by <a href="https://www.andersnoren.se/">Anders Norén</a></span></p>

			</div><!-- .section-inner -->

		</div><!-- .credits.section -->

		<script>

window.addEventListener('sfsi_functions_loaded', function() {
    if (typeof sfsi_time_pop_up == 'function') {
        sfsi_time_pop_up(60000);
    }
})
</script>
    <script>
        window.addEventListener('sfsi_functions_loaded', function() {
            if (typeof sfsi_plugin_version == 'function') {
                sfsi_plugin_version(2.63);
            }
        });

        function sfsi_processfurther(ref) {
            var feed_id = 'TTRLWlV4Zk9MSGt3UFMvMitOQkFSN1JpblpHU3RiTVEvY3I0cFl3TVdZbVVuSDdsSEhBSDFxWGtGTm5xWnl5Um5ZTjVqeDNmUkRHN3luM3hKTEIvemErL05kRWI1Z3RUMTN5VkhCNGhUOERxU21teHJBZTdwUlpIY1JQdTdlMSt8R2YrYTY3UUZuNkp4S1NEeUFQZW9uL2NTSjN5dFZqNTBEMGJEMVFtY2p4OD0=';
            var feedtype = 8;
            var email = jQuery(ref).find('input[name="email"]').val();
            var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
            if ((email != "Enter your email") && (filter.test(email))) {
                if (feedtype == "8") {
                    var url = "https://api.follow.it/subscription-form/" + feed_id + "/" + feedtype;
                    window.open(url, "popupwindow", "scrollbars=yes,width=1080,height=760");
                    return true;
                }
            } else {
                alert("Please enter email address");
                jQuery(ref).find('input[name="email"]').focus();
                return false;
            }
        }
    </script>
    <style type="text/css" aria-selected="true">
        .sfsi_subscribe_Popinner {
            width: 100% !important;

            height: auto !important;

            border: 1px solid #b5b5b5 !important;

            padding: 18px 0px !important;

            background-color: #ffffff !important;

        }

        .sfsi_subscribe_Popinner form {

            margin: 0 20px !important;

        }

        .sfsi_subscribe_Popinner h5 {

            font-family: Helvetica,Arial,sans-serif !important;

            font-weight: bold !important;

            color: #000000 !important;

            font-size: 16px !important;

            text-align: center !important;

            margin: 0 0 10px !important;

            padding: 0 !important;

        }

        .sfsi_subscription_form_field {

            margin: 5px 0 !important;

            width: 100% !important;

            display: inline-flex;

            display: -webkit-inline-flex;

        }

        .sfsi_subscription_form_field input {

            width: 100% !important;

            padding: 10px 0px !important;

        }

        .sfsi_subscribe_Popinner input[type=email] {

            font-family: Helvetica,Arial,sans-serif !important;

            font-style: normal !important;

            color:  !important;

            font-size: 14px !important;

            text-align: center !important;

        }

        .sfsi_subscribe_Popinner input[type=email]::-webkit-input-placeholder {

            font-family: Helvetica,Arial,sans-serif !important;

            font-style: normal !important;

            color:  !important;

            font-size: 14px !important;

            text-align: center !important;

        }

        .sfsi_subscribe_Popinner input[type=email]:-moz-placeholder {
            /* Firefox 18- */

            font-family: Helvetica,Arial,sans-serif !important;

            font-style: normal !important;

            color:  !important;

            font-size: 14px !important;

            text-align: center !important;

        }

        .sfsi_subscribe_Popinner input[type=email]::-moz-placeholder {
            /* Firefox 19+ */

            font-family: Helvetica,Arial,sans-serif !important;

            font-style: normal !important;

            color:  !important;

            font-size: 14px !important;

            text-align: center !important;

        }

        .sfsi_subscribe_Popinner input[type=email]:-ms-input-placeholder {

            font-family: Helvetica,Arial,sans-serif !important;

            font-style: normal !important;

            color:  !important;

            font-size: 14px !important;

            text-align: center !important;

        }

        .sfsi_subscribe_Popinner input[type=submit] {

            font-family: Helvetica,Arial,sans-serif !important;

            font-weight: bold !important;

            color: #000000 !important;

            font-size: 16px !important;

            text-align: center !important;

            background-color: #dedede !important;

        }

        .sfsi_shortcode_container {
            float: left;
        }

        .sfsi_shortcode_container .norm_row .sfsi_wDiv {
            position: relative !important;
        }

        .sfsi_shortcode_container .sfsi_holders {
            display: none;
        }

            </style>

<script type="text/javascript" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/core.min.js.Без названия" id="jquery-ui-core-js"></script>
<script type="text/javascript" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/modernizr.custom.min.js.Без названия" id="SFSIjqueryModernizr-js"></script>
<script type="text/javascript" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/jquery.shuffle.min.js.Без названия" id="SFSIjqueryShuffle-js"></script>
<script type="text/javascript" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/random-shuffle-min.js.Без названия" id="SFSIjqueryrandom-shuffle-js"></script>
<script type="text/javascript" id="SFSICustomJs-js-extra">
/* <![CDATA[ */
var sfsi_icon_ajax_object = {"ajax_url":"https:\/\/ponderthebits.com\/wp-admin\/admin-ajax.php"};
var sfsi_icon_ajax_object = {"ajax_url":"https:\/\/ponderthebits.com\/wp-admin\/admin-ajax.php","plugin_url":"https:\/\/ponderthebits.com\/wp-content\/plugins\/ultimate-social-media-icons\/"};
/* ]]> */
</script>
<script type="text/javascript" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/custom.js.Без названия" id="SFSICustomJs-js"></script>
<script type="text/javascript" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/global.js.Без названия" id="lovecraft_global-js"></script>
<script type="text/javascript" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/comment-reply.min.js.Без названия" id="comment-reply-js"></script>
<script type="text/javascript" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/wp-embed.min.js.Без названия" id="wp-embed-js"></script>
<script type="text/javascript" id="cptch_front_end_script-js-extra">
/* <![CDATA[ */
var cptch_vars = {"nonce":"f2f72899ff","ajaxurl":"https:\/\/ponderthebits.com\/wp-admin\/admin-ajax.php","enlarge":""};
/* ]]> */
</script>
<script type="text/javascript" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/front_end_script.js.Без названия" id="cptch_front_end_script-js"></script>

	

<iframe scrolling="no" frameborder="0" allowtransparency="true" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/widget_iframe.58065ae230495f5d9e4b6a916472b2c1.html" title="Twitter settings iframe" style="display: none;"></iframe><script>mendeleyWebImporter = {
  downloadPdfs(t,e) { return this._call('downloadPdfs', [t,e]); },
  open() { return this._call('open', []); },
  setLoginToken(t) { return this._call('setLoginToken', [t]); },
  _call(methodName, methodArgs) {
    const id = Math.random();
    window.postMessage({ id, token: '0.025741787644105285', methodName, methodArgs }, 'https://ponderthebits.com');
    return new Promise(resolve => {
      const listener = window.addEventListener('message', event => {
        const data = event.data;
        if (typeof data !== 'object' || !('result' in data) || data.id !== id) return;
        window.removeEventListener('message', listener);
        resolve(data.result);
      });
    });
  }
};</script><script id="cptch_script_loader" type="text/javascript"></script><iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: none;" title="Twitter analytics iframe" src="./Windows RDP-Related Event Logs_ Identification, Tracking, and Investigation _ Ponder The Bits_files/saved_resource(1).html"></iframe></body></html>